/*! caminio-lineup 2014-06-27 
* Copyright (c) 2014 <YOUR COMPANY HERE> 
* Available via the MIT license.
* see: http://opensource.org/licenses/MIT for blueprint.
*/
!function(a){"use strict";a.LabelItemController=Em.ObjectController.extend({isActive:function(){return this.get("parentController.searchQ.labels").findBy("id",this.get("content.id"))}.property("parentController.searchQ.labels.@each"),actions:{removeLabel:function(b){var c=this;bootbox.confirm(Em.I18n.t("label.really_delete",{name:b.get("name")}),function(d){d&&(b.deleteRecord(),b.save().then(function(){a.set("_availableLabels",c.store.find("label",{type:"lineup"})),notify("info",Em.I18n.t("label.deleted",{name:b.get("name")}))}).catch(function(a){notify("error",a)}))})}}})}(App),function(a){"use strict";a._curLang=currentDomain.lang;var b=Em.Object.extend({title:null,end:null,createdBy:null,startsAt:null,onlyMine:function(a,b){return"undefined"!=typeof b&&this.set("createdBy",b?currentUser._id:null),"string"==typeof this.get("createdBy")}.property("createdBy"),onlyFuture:function(a,b){return"undefined"!=typeof b&&this.set("startsAt",b?moment().startOf("day").toISOString():null),"string"==typeof this.get("startsAt")}.property("startsAt"),labels:Em.A(),toJSON:function(){var a={};return Em.isEmpty(this.get("title"))||(a["translations.title"]="regexp(/"+this.get("title")+"/i)"),Em.isEmpty(this.get("startsAt"))||(a["lineup_events.starts"]="gteDate("+this.get("startsAt")+")"),Em.isEmpty(this.get("end"))||(a.start=this.get("end")),Em.isEmpty(this.get("createdBy"))||(a.createdBy=this.get("createdBy")),this.get("labels.length")>0&&(a.labels="in("+this.get("labels").map(function(a){return a.get("id")}).join(",")+")"),a}});a.LineupEntriesController=Ember.Controller.extend({needs:["lineup_entries_table"],multiLangs:function(){return domainSettings.availableLangs.length>1}.property(),availableLangs:function(){return domainSettings.availableLangs}.property(),searchQ:b.create({createdBy:a.get("emberUser.isAdmin")?null:currentUser._id,startsAt:moment().startOf("day").toISOString()}),actions:{changeLang:function(b){a.set("_curLang",b)},"export":function(){location.href="/caminio/lineup/"+currentDomain._id+"/export?dialect=dat"},newItem:function(){this.transitionToRoute("lineup_entries.new")},search:function(){this.get("controllers.lineup_entries_table").set("content",this.store.find("lineup_entry",this.get("searchQ").toJSON())),a._selTableItems.clear()},toggleAdvSearch:function(){this.set("advSearch",this.get("advSearch")?!1:!0),this.get("advSearch")?setTimeout(function(){$(".adv-search").slideDown(),$(".search-group").slideUp()},1):($(".adv-search").slideUp(),$(".search-group").slideDown())},toggleLabelOrLabelContent:function(b){a.get("_selTableItems.length")?a.get("_selTableItems").forEach(function(a){a.get("labels").findBy("id",b.get("id"))?a.get("labels").removeObject(b):a.get("labels").pushObject(b),a.save()}):(this.get("searchQ.labels").findBy("id",b.get("id"))?this.get("searchQ.labels").removeObject(b):this.get("searchQ.labels").pushObject(b),this.send("search"))}}})}(App),function(){"use strict";function a(a,b,c){var d=this.store.getById("lineup_person",a),e=this.store.createRecord("lineup_job",{title:c,lineup_person:d});this.get("content.lineup_jobs").pushObject(e),this.get("content").send("becomeDirty"),b.select2("val","")}function b(a,b,c){var d=this,e=this.store.createRecord("lineup_person",{name:a}),f=this.store.createRecord("translation",{locale:App._curLang});e.get("translations").pushObject(f),e.set("curTranslation",f),e.save().then(function(){notify("info",Em.I18n.t("person.created",{name:e.get("name")})),d.get("availablePeople").pushObject(e);var a=d.store.createRecord("lineup_job",{title:c,lineup_person:e});d.get("content.lineup_jobs").pushObject(a),b.append('<option value="'+e.get("id")+'">'+e.get("name")+"</option>"),b.select2("val","")})}App.LineupEntriesEditController=Ember.ObjectController.extend({availableVenues:Em.A(),availablePeople:Em.A(),availableEnsembles:Em.A(),availableLabels:Em.A(),availableCategories:Em.A(domainSettings.lineupAvailableCategories||[]),aside2Available:!Em.isEmpty(domainSettings.aside2),aside3Available:!Em.isEmpty(domainSettings.aside3),editSettings:!1,domainSettings:domainSettings,youtubeVideoURL:function(){return"//www.youtube-nocookie.com/embed/"+this.get("videoId")}.property("videoId"),vimeoVideoURL:function(){return"//player.vimeo.com/video/"+this.get("videoId")+"?byline=0"}.property("videoId"),_createTr:function(){var a=this.store.createRecord("translation",{locale:App._curLang,content:Em.I18n.t("content_here")});this.get("content.translations").pushObject(a)},domainCategories:function(){return domainSettings.lineupCategories||["Theater Tanz Performance","Junges Publikum","Kabaret","Festival"]}.property(),isVimeo:function(){return"vimeo"===this.get("videoProvider")}.property("videoProvider"),arrangedEvents:function(){return this.get("lineup_events").sortBy("starts").toArray().reverse()}.property("lineup_events.@each"),actions:{cancelNewEntry:function(){this.get("model").deleteRecord(),this.transitionToRoute("lineup_entries")},toggleEditSettings:function(){this.set("editSettings",!this.get("editSettings"))},goToEntries:function(){this.transitionToRoute("lineup_entries")},toggleVideoProvider:function(){return"youtube"===this.get("videoProvider")?this.set("videoProvider","vimeo"):this.set("videoProvider","youtube")},togglePublished:function(){var a=this.get("content");a.set("status",a.get("status")&&"draft"!==a.get("status")?"draft":"published"),a.save().then(function(){"draft"===a.get("status")?notify("info",Em.I18n.t("entry.marked_draft",{name:a.get("curTranslation.title")})):notify("info",Em.I18n.t("entry.marked_published",{name:a.get("curTranslation.title")}))}).catch(function(){notify("error",Em.I18n.t("entry.saving_failed",{name:a.get("curTranslation.title")}))})},changeLang:function(a){var b=this.get("content.translations").find(function(b){return b.get("locale")===a});b||(b=this.store.createRecord("translation",{locale:a,title:this.get("content.curTranslation.title"),subtitle:this.get("content.curTranslation.subtitle"),aside:this.get("content.curTranslation.aside"),content:this.get("content.curTranslation.content")}),this.get("content.translations").pushObject(b)),App.set("_curLang",a)},remove:function(a){var b=this;bootbox.confirm(Em.I18n.t("entry.really_delete",{name:a.get("name")}),function(c){c&&(a.deleteRecord(),a.save().then(function(){notify("info",Em.I18n.t("entry.deleted",{name:a.get("curTranslation.title")})),b.transitionToRoute("lineup_entries")}))})},save:function(){var a=this;return this.get("curTranslation.title")?void this.get("content").save().then(function(){notify("info",Em.I18n.t("entry.saved",{name:a.get("curTranslation.title")})),a.get("content").reload(),a.transitionToRoute("lineup_entries.edit",a.get("content.id"))}):(this.set("titleError",!0),$("#entry-title").focus(),notify("error",Em.I18n.t("error.missing_title")))},addEvent:function(){var a=this.get("content");this.get("model.lineup_events").forEach(function(b){b.get("isNew")&&a.get("lineup_events").removeObject(b),b.set("editMode",!1)});var b,c,d=this.get("model.lineup_events.lastObject");d&&(b=d.get("lineup_org"),c=d.get("festival"),d=d.toJSON(),delete d.lineup_org,delete d.starts,delete d.lineup_entry);var e=this.store.createRecord("lineup_event",d?d:{});b&&e.set("lineup_org",b),c&&e.set("festival",c),this.get("lineup_events").pushObject(e),e.set("lineup_entry",this.get("model")),e.set("editMode",!0),this.get("curEvent")&&this.get("curEvent").set("editMode",!1),this.get("curEvent",e)},addJob:function(){var a=this.store.createRecord("lineup_job");this.get("lineup_jobs").pushObject(a),a.set("editMode",!0),this.get("curJob")&&this.get("curJob").set("editMode",!1),this.get("curJob",a),$("#lineup-jobs").sortable("refresh")},removeLabel:function(a){bootbox.confirm(Em.I18n.t("label.really_delete",{name:a.get("name")}),function(b){b&&(a.deleteRecord(),a.save().then(function(){notify("info",Em.I18n.t("label.deleted",{name:a.get("name")}))}).catch(function(a){notify("error",a)}))})},toggleLabel:function(a){var b=this.get("content.labels").find(function(b){return a.get("id")===b.get("id")?!0:void 0});b?this.get("content.labels").removeObject(a):this.get("content.labels").pushObject(a)},createEnsemble:function(a,b){var c=this,d=this.store.createRecord("lineup_org",{type:"ensemble"}),e=this.store.createRecord("translation",{locale:App._curLang,title:a});d.get("translations").pushObject(e),d.set("curTranslation",e),d.save().then(function(){notify("info",Em.I18n.t("ensemble.created",{name:d.get("curTranslation.title")})),c.get("availableEnsembles").pushObject(d),c.get("content.ensembles").pushObject(d),b.append('<option value="'+d.get("id")+'">'+d.get("curTranslation.title")+"</option>"),b.select2("val","")})},addEnsemble:function(a,b){var c=this.store.getById("lineup_org",a);this.get("content.ensembles").pushObject(c),this.get("content").send("becomeDirty"),b.select2("val","")},addAuthor:function(b,c){a.call(this,b,c,Em.I18n.t("job.author"))},addDirector:function(b,c){a.call(this,b,c,Em.I18n.t("job.director"))},createAuthor:function(a,c){b.call(this,a,c,Em.I18n.t("job.author"))},createDirector:function(a,c){b.call(this,a,c,Em.I18n.t("job.director"))}}}),App.LineupEntriesNewController=App.LineupEntriesEditController.extend(),App.EnsemblesItemController=Ember.ObjectController.extend({actions:{goToEnsemble:function(){this.transitionToRoute("lineup_orgs.edit",this.get("content.id"))},removeEnsemble:function(){this.get("parentController.content.ensembles").removeObject(this.get("content")),this.get("parentController.content").send("becomeDirty")}}}),App.JobsItemController=Ember.ObjectController.extend({actions:{goToPerson:function(){this.transitionToRoute("lineup_people.edit",this.get("content.lineup_person.id"))},removePerson:function(){this.get("parentController.content.lineup_jobs").removeObject(this.get("content")),this.get("parentController.content").send("becomeDirty")}}})}.call(),function(a){"use strict";a.LineupEntriesTableController=a.TableController.extend({sortAscending:!1,tableHeaders:Em.A([{name:"curTranslation.title",title:"entry.title"},{name:"period",title:"entry.date",width:"150px"},{name:"venues",title:"entry.venues"},{name:"updatedAt",title:"updated_at",width:"100px"},{name:"updatedBy",title:"updated_by",width:"100px"}])})}(App),function(){"use strict";App.LineupEntryController=App.TableItemController.extend({period:function(){var a,b;return this.get("content.lineup_events").forEach(function(c){(!a||c.get("starts")<=a)&&(a=c.get("starts")),(!b||c.get("starts")>=b)&&(b=c.get("starts"))}),a&&this.get("content.lineup_events.length")<2?new Handlebars.SafeString(moment(a).format("DD.MMM. HH:mm")):a&&b?new Handlebars.SafeString(moment(a).format("DD.MMM.")+" &ndash; "+moment(b).format("DD.MMM.")):""}.property("lineup_events.@each"),actions:{togglePublished:function(){var a=this.get("content");a.set("status",a.get("status")&&"draft"!==a.get("status")?"draft":"published"),a.save().then(function(){"draft"===a.get("status")?notify("info",Em.I18n.t("entry.marked_draft",{name:a.get("curTranslation.title")})):notify("info",Em.I18n.t("entry.marked_published",{name:a.get("curTranslation.title")}))}).catch(function(){notify("error",Em.I18n.t("entry.saving_failed",{name:a.get("curTranslation.title")}))})},editItem:function(a){this.transitionToRoute("lineup_entries.edit",a.get("id"))}}})}.call(),function(){"use strict";App.LineupEventController=Ember.ObjectController.extend({editFestival:!1,isCurrent:function(){return this.get("content.id")===this.get("parentController.curEvent.id")}.property("parentController.curFile"),pastEvent:function(){return moment(this.get("starts")).isValid()?moment(this.get("starts")).endOf("day")<moment():!1}.property("content.start"),actions:{createVenue:function(a,b){var c=this,d=this.get("parentController").store.createRecord("lineup_org",{type:"venue"}),e=this.get("parentController").store.createRecord("translation",{locale:App._curLang,title:a});d.get("translations").pushObject(e),d.set("curTranslation",e),d.save().then(function(){notify("info",Em.I18n.t("venue.created",{name:d.get("curTranslation.title")})),c.get("parentController.availableVenues").pushObject(d),c.get("content").set("lineup_org",d),b.append('<option value="'+d.get("id")+'">'+d.get("curTranslation.title")+"</option>"),b.select2("val",d.get("id"))})},addVenue:function(a){var b=this.store.getById("lineup_org",a);this.get("content").set("lineup_org",b)},createFestival:function(a,b){var c=this,d=this.get("parentController").store.createRecord("lineup_entry",{categories:"festival"}),e=this.get("parentController").store.createRecord("translation",{locale:App._curLang,title:a});d.get("translations").pushObject(e),d.set("curTranslation",e),d.save().then(function(){notify("info",Em.I18n.t("festival.created",{name:d.get("curTranslation.title")})),App.get("_availableFestivals").pushObject(d),c.get("content").set("festival",d),b.append('<option value="'+d.get("id")+'">'+d.get("curTranslation.title")+"</option>"),b.select2("val",d.get("id"))})},addFestival:function(a){var b=this.store.getById("lineup_event",a);this.get("content").set("festival",b)},toggleFestival:function(){this.set("editFestival",!this.get("editFestival")),this.get("content.festival")&&!this.get("editFestival")&&this.get("content").set("festival",null)},toggleSpecial:function(a){this.set("content."+a,!this.get("content."+a))},save:function(){var a=this.get("content");if(!a.get("lineup_org"))return $(".lineup-event.editing:visible .select2-container").addClass("error"),notify("error",Em.I18n.t("event.venue_required"));$(".lineup-event.editing:visible .select2-container").removeClass("error");var b=this;this.get("parentController.content.lineup_events").sortBy("starts"),this.get("parentController.content").save().then(function(){return notify("info",Em.I18n.t("event.saved",{starts:moment(a.get("starts")).format("LLLL")})),a.get("isNew")?void b.get("parentController.content.lineup_events").removeObject(a):a.set("editMode",!1)})},remove:function(a){this.get("parentController.content.lineup_events").removeObject(a)},toggleEditMode:function(){var a=this.get("content");return this.get("parentController.lineup_events").forEach(function(b){b.id!==a.id&&b.set("editMode",!1)}),this.get("content.isNew")?(this.get("parentController.lineup_events").removeObject(this.get("content")),this.get("content").deleteRecord()):void this.get("content").set("editMode",this.get("content.editMode")?!this.get("content.editMode"):!0)}}})}.call(),function(){"use strict";App.LineupJobController=Ember.ObjectController.extend({actions:{createPerson:function(a,b){var c=this,d=this.get("parentController").store.createRecord("lineup_person",{firstname:a.split(/\s+/)[0],lastname:a.split(/\s+/)[1]});d.save().then(function(){notify("info",Em.I18n.t("person.created",{name:d.get("name")})),c.get("parentController.availablePeople").pushObject(d),c.get("content").set("lineup_person",d),b.append('<option value="'+d.get("id")+'">'+d.get("name")+"</option>"),b.select2("val",d.get("id"))})},save:function(){var a=this.get("content");return a.get("lineup_person")?(this.get("parentController.content").send("becomeDirty"),a.set("editMode",!1)):($(".job.editing:visible .select2-container").addClass("error"),notify("error",Em.I18n.t("event.person_required")))},remove:function(a){this.get("parentController.content.lineup_jobs").removeObject(a)},toggleEditMode:function(){return this.get("content.id")?void this.get("content").set("editMode",this.get("content.editMode")?!this.get("content.editMode"):!0):(this.get("parentController.lineup_jobs").removeObject(this.get("content")),this.get("content").deleteRecord())}}})}.call(),function(){"use strict";App.LineupMediafileController=Ember.ObjectController.extend({isCurrent:function(){return this.get("content.id")===this.get("parentController.curFile.id")}.property("parentController.curFile"),actions:{removeMediafile:function(){var a=this.get("content"),b=this.get("parentController");bootbox.confirm(Em.I18n.t("file.really_delete",{name:a.get("name")}),function(c){c&&(a.deleteRecord(),a.save().then(function(){notify("info",Em.I18n.t("file.deleted",{name:a.get("name")})),b.set("mediafiles",App.Mediafile.store.find("mediafile",{parent:b.get("model.id")}))}))})},showFileDetails:function(a){this.get("parentController").send("editMediafileModal",a)}}})}.call(),function(a){"use strict";a.LineupOrgController=a.TableItemController.extend({curTranslation:function(){return this.get("content.translations").findBy("locale",a._curLang)}.property("App._curLang"),actions:{editItem:function(a){this.transitionToRoute("lineup_orgs.edit",a.get("id"))},togglePublished:function(){var a=this.get("content");a.set("status",a.get("status")&&"draft"!==a.get("status")?"draft":"published"),a.save().then(function(){"draft"===a.get("status")?notify("info",Em.I18n.t("entry.marked_draft",{name:a.get("curTranslation.title")})):notify("info",Em.I18n.t("entry.marked_published",{name:a.get("curTranslation.title")}))}).catch(function(){notify("error",Em.I18n.t("entry.saving_failed",{name:a.get("curTranslation.title")}))})}}})}(App),function(){"use strict";App._curLang=currentDomain.lang;var a=Em.Object.extend({title:null,start:null,end:null,createdBy:null,labels:Em.A(),toJSON:function(){var a={};return this.get("title")&&(a["translations.title"]="regexp(/"+this.get("title")+"/i)"),this.get("start")&&(a.start=this.get("start")),this.get("end")&&(a.start=this.get("end")),this.get("createdBy")&&(a.createdBy=this.get("createdBy")),a}});App.LineupOrgsController=Ember.Controller.extend({needs:["lineup_orgs_table"],curLang:currentDomain.lang,searchQ:a.create({createdBy:currentUser._id}),actions:{changeLang:function(a){App.set("_curLang",a)},newItem:function(){this.transitionToRoute("lineup_venues.new")},search:function(){this.get("controllers.lineup_orgs_table").set("content",this.store.find("lineup_org",this.get("searchQ").toJSON())),App._selTableItems.clear()},toggleAdvSearch:function(){this.set("advSearch",this.get("advSearch")?!1:!0),this.get("advSearch")?setTimeout(function(){$(".adv-search").slideDown(),$(".search-group").slideUp()},1):($(".adv-search").slideUp(),$(".search-group").slideDown())},toggleLabelOrLabelContent:function(a){App.get("_selTableItems.length")?App.get("_selTableItems").forEach(function(b){b.get("labels").findBy("id",a.get("id"))?b.get("labels").removeObject(a):b.get("labels").pushObject(a),b.save()}):(this.get("searchQ.labels").findBy("id",a.get("id"))?this.get("searchQ.labels").removeObject(a):this.get("searchQ.labels").pushObject(a),this.send("search"))}}})}.call(),function(a){"use strict";a.LineupOrgsEditController=Ember.ObjectController.extend({youtubeVideoURL:function(){return"//www.youtube-nocookie.com/embed/"+this.get("videoId")}.property("videoId"),vimeoVideoURL:function(){return"//player.vimeo.com/video/"+this.get("videoId")+"?byline=0"}.property("videoId"),_createTr:function(){var b=this.store.createRecord("translation",{locale:a._curLang,content:Em.I18n.t("content_here")});this.get("content.translations").pushObject(b)},isVimeo:function(){return"vimeo"===this.get("videoProvider")}.property("videoProvider"),actions:{toggleVideoProvider:function(){return"youtube"===this.get("videoProvider")?this.set("videoProvider","vimeo"):this.set("videoProvider","youtube")},toggleLabel:function(a){var b=this.get("content.labels").find(function(b){return a.get("id")===b.get("id")?!0:void 0});b?this.get("content.labels").removeObject(a):this.get("content.labels").pushObject(a)},changeLang:function(b){var c=this.get("content.translations").find(function(a){return a.get("locale")===b});c||(c=this.store.createRecord("translation",{locale:b,title:this.get("content.curTranslation.title"),subtitle:this.get("content.curTranslation.subtitle"),aside:this.get("content.curTranslation.aside"),content:this.get("content.curTranslation.content")}),this.get("content.translations").pushObject(c)),a.set("_curLang",b)},goToOrgs:function(){this.transitionToRoute("lineup_orgs")},setType:function(a){this.get("content").set("type",a)},remove:function(a){var b=this;bootbox.confirm(Em.I18n.t("entry.really_delete",{name:a.get("curTranslation.title")}),function(c){c&&(a.deleteRecord(),a.save().then(function(){notify("info",Em.I18n.t("entry.deleted",{name:a.get("curTranslation.title")})),b.transitionToRoute("lineup_orgs")}))})},save:function(){var a=this;return this.get("curTranslation.title")?void this.get("content").save().then(function(){notify("info",Em.I18n.t("org.saved",{name:a.get("curTranslation.title")})),a.transitionToRoute("lineup_orgs.edit",a.get("content.id"))}):(this.set("titleError",!0),$("#entry-title").focus(),notify("error",Em.I18n.t("error.missing_title")))}}}),a.LineupOrgsNewController=a.LineupOrgsEditController.extend()}(App),function(a){"use strict";a.LineupOrgsTableController=a.TableController.extend({sortAscending:!1,tableHeaders:Em.A([{name:"curTranslation.title",title:"org.name"},{name:"city",title:"org.city"},{name:"updatedAt",title:"updated_at"},{name:"updatedBy",title:"updated_by"}])})}(App),function(a){"use strict";a._curLang=currentDomain.lang;var b=Em.Object.extend({title:null,start:null,end:null,createdBy:null,labels:Em.A(),toJSON:function(){var a={};return this.get("title")&&(a["translations.title"]="regexp(/"+this.get("title")+"/i)"),this.get("start")&&(a.start=this.get("start")),this.get("end")&&(a.start=this.get("end")),this.get("createdBy")&&(a.createdBy=this.get("createdBy")),a}});a.LineupPeopleController=Ember.Controller.extend({needs:["lineup_people_table"],multiLangs:function(){return domainSettings.availableLangs.length>1}.property(),availableLangs:function(){return domainSettings.availableLangs}.property(),searchQ:b.create({createdBy:currentUser._id}),actions:{changeLang:function(b){a.set("_curLang",b)},newItem:function(){this.transitionToRoute("lineup_people.new")},search:function(){this.get("controllers.lineup_people_table").set("content",this.store.find("lineup_person",this.get("searchQ").toJSON())),a._selTableItems.clear()},toggleAdvSearch:function(){this.set("advSearch",this.get("advSearch")?!1:!0),this.get("advSearch")?setTimeout(function(){$(".adv-search").slideDown(),$(".search-group").slideUp()},1):($(".adv-search").slideUp(),$(".search-group").slideDown())},toggleLabelOrLabelContent:function(b){a.get("_selTableItems.length")?a.get("_selTableItems").forEach(function(a){a.get("labels").findBy("id",b.get("id"))?a.get("labels").removeObject(b):a.get("labels").pushObject(b),a.save()}):(this.get("searchQ.labels").findBy("id",b.get("id"))?this.get("searchQ.labels").removeObject(b):this.get("searchQ.labels").pushObject(b),this.send("search"))}}})}(App),function(a){"use strict";a.LineupPeopleEditController=Ember.ObjectController.extend({youtubeVideoURL:function(){return"//www.youtube-nocookie.com/embed/"+this.get("videoId")}.property("videoId"),vimeoVideoURL:function(){return"//player.vimeo.com/video/"+this.get("videoId")+"?byline=0"}.property("videoId"),_createTr:function(){var b=this.store.createRecord("translation",{locale:a._curLang,content:Em.I18n.t("content_here")});this.get("content.translations").pushObject(b)},isVimeo:function(){return"vimeo"===this.get("videoProvider")}.property("videoProvider"),actions:{toggleVideoProvider:function(){return"youtube"===this.get("videoProvider")?this.set("videoProvider","vimeo"):this.set("videoProvider","youtube")},toggleLabel:function(a){var b=this.get("content.labels").find(function(b){return a.get("id")===b.get("id")?!0:void 0});b?this.get("content.labels").removeObject(a):this.get("content.labels").pushObject(a)},changeLang:function(b){var c=this.get("content.translations").find(function(a){return a.get("locale")===b});c||(c=this.store.createRecord("translation",{locale:b,title:this.get("content.curTranslation.title"),subtitle:this.get("content.curTranslation.subtitle"),aside:this.get("content.curTranslation.aside"),content:this.get("content.curTranslation.content")}),this.get("content.translations").pushObject(c)),a.set("_curLang",b)},goToPeople:function(){this.transitionToRoute("lineup_people")},setType:function(a){this.get("content").set("type",a)},remove:function(a){var b=this;bootbox.confirm(Em.I18n.t("entry.really_delete",{name:a.get("curTranslation.title")}),function(c){c&&(a.deleteRecord(),a.save().then(function(){notify("info",Em.I18n.t("entry.deleted",{name:a.get("curTranslation.title")})),b.transitionToRoute("lineup_people")}))})},save:function(){var a=this;return this.get("firstname")?void this.get("content").save().then(function(){notify("info",Em.I18n.t("person.saved",{name:a.get("curTranslation.title")})),a.transitionToRoute("lineup_people.edit",a.get("content.id"))}):(this.set("firstnameError",!0),$("#entry-firstname").focus(),notify("error",Em.I18n.t("error.missing_firstname")))}}}),a.LineupPeopleNewController=a.LineupPeopleEditController.extend()}(App),function(a){"use strict";a.LineupPeopleTableController=a.TableController.extend({sortAscending:!1,tableHeaders:Em.A([{name:"name",title:"person.name"},{name:"city",title:"org.city"},{name:"updatedAt",title:"updated_at"},{name:"updatedBy",title:"updated_by"}])})}(App),function(a){"use strict";a.LineupPersonController=a.TableItemController.extend({curTranslation:function(){return this.get("content.translations").findBy("locale",a._curLang)}.property("App._curLang"),actions:{editItem:function(a){this.transitionToRoute("lineup_people.edit",a.get("id"))},togglePublished:function(){var a=this.get("content");a.set("status",a.get("status")&&"draft"!==a.get("status")?"draft":"published"),a.save().then(function(){"draft"===a.get("status")?notify("info",Em.I18n.t("entry.marked_draft",{name:a.get("curTranslation.title")})):notify("info",Em.I18n.t("entry.marked_published",{name:a.get("curTranslation.title")}))}).catch(function(){notify("error",Em.I18n.t("entry.saving_failed",{name:a.get("curTranslation.title")}))})}}})}(App),function(){"use strict";if("de"===currentLang){var a={"nav.overview":"Übersicht","nav.entries":"Einträge","nav.organizations":"Spielorte / Ensembles","nav.people":"Personen","nav.settings":"Einstellungen","entries.export":"Spielplan exportieren",lineup_overview:"Übersicht",only_future:"Nur Termine in der Zukunft","entries.title":"Einträge im Spielplan","entry.title":"Titel","entry.adv_settings":"Erweiterte Einstellungen","entry.last_changes":"Letzte Änderungen","entry.notify_creator_on_change":"BesitzerIn benachrichtigen wenn jemand anderes Änderungen am Eintrag vornimmt","entry.labels":"Labels","entry.currently_labeled":"ist aktuell gelabelt mit","entry.available_labels":"Verfügbare Labels","entry.no_labels":"Keinem Label","entry.click_label":"Auf eines der verfügbaren Labels unterhalb klicken um diesen Spielplaneintrag damit zu markieren","entry.video_id":"Video einbetten (ID)","entry.video_provider":"Video-Provider","entry.subtitle":"Untertitel","entry.date":"Datum","entry.venues":"Spielorte","entry.create":"Neuer Spielplaneintrag","entry.description":"Beschreibung","entry.meta_keywords":"Schlagwörter","entry.author":"Autorenschaft","entry.director":"Inszenierung","entry.keywords":"Schlagwörter","entry.save_before_content":"Eintrag speichern, um diese Einstellungen verfügbar zu machen","entry.concessions":"Ermäßigungen","entry.book_email":"Reservierungen Email","entry.book_phone":"Reservierungen Telefon","entry.book_url":"Reservierungslink","entry.note":"Notiz","entry.function":"Funktion","entry.marketing_adv":"Marketing / Erweitert","entry.orig_project_url":"Projekt URL (extern)","entry.orig_project_url_desc":"z.B..: http://example.com/path/to/project","entry.vimeo":"Vimeo (http://vimeo.com)","entry.youtube":"Youtube (http://youtube.com)","entry.linked_media_placeholder":"z.B..: 6ddpV1GvF7E","entry.youtube_desc":"Youtube-Id aus der Youtube-Adresse herauskopieren und hier einsetzen. Beispiel: Der Link lautet: http://www.youtube.com/watch?v=6ddpV1GvF7E - die ID davon ist: 66dpV1GvF7E","entry.vimeo_desc":"Youtube-Id aus der Youtube-Adresse herauskopieren und hier einsetzen. Beispiel: Der Link lautet: http://vimeo.com/92688138 - die ID davon ist 92688138","entry.video_switch":"Video-Provider wählen","entry.premiere":"Premiere","entry.derniere":"Derniere","entry.cancelled":"Abgesagt","entry.festival":"Festival","entry.select_festival":"Festival auswählen (oder neues anlegen)","entry.no_festival_found_create_new":"Kein Festival gefunden (neues anlegen?)","festival.created":"Festival {{name}} wurde angelegt","entry.draft":"Entwurf","entry.published":"Veröffentlicht","entry.marked_published":"{{name}} ist jetzt veröffentlicht","entry.marked_draft":"Veröffentlichung von {{name}} wurde zurückgezogen","entry.ttp":"Theatre / Tanz / Performance","entry.youth":"Junges Publikum","entry.cab":"Kabaret","entry.fes":"Festival","entry.category":"Kategorie","entry.duration":"Dauer","entry.breaks":"Anzahl Pausen","entry.from_age_of":"ab","entry.years":"Jahren","entry.filename":"Dateiname / Teil der Internetadresse","entry.press_voices":"Pressestimmen","entry.media":"Medien","entry.saved":"Eintrag {{name}} wurde gespeichert","entry.saving_failed":"{{name}} konnte nicht gespeichert werden","entry.deleted":"Eintrag {{name}} wurde gelöscht","entry.really_delete":"{{name}} wirklich löschen?","entry.ensembles":"Ensembles","entries.search":"Such","entries.search.quick":"Schnelle Suche","entries.search.advanced":"Erweiterte Suche",events:"Termine","events.add":"Termin hinzufügen","event.no_yet":"Kein Termin eingetragen","event.starts_placeholder":"JJJJ-MM-TT","event.starts_time_placeholder":"HH:MM","event.select_venue":"Spielort auswählen oder neuen Namen eintragen","event.edit_prices":"Preise bearbeiten","event.nothing_found_create_new":"Keine Ergebnisse. [ENTER] legt diesen Namen an","event.saved":"Termin {{starts}} wurde erstellt","event.venue_required":"Ohne Spielort kann der Termin nicht angelegt werden","event.person_required":"Bitte eine Person zuordnen","org.created":"Spielort {{name}} wurde erstellt","org.title":"Spielorte","org.type":"Typ","org.type.venue":"Spielort","org.type.ensemble":"Ensemble","org.type.organizer":"Organisator","org.create":"Neuer Spielort","org.name":"Name","org.country":"Land","org.city":"Stadt","org.address":"Adresse","org.saved":"Organisation {{name}} wurde gespeichert","org.orig_org_url":"Link zur Webseite","org.contact":"Kontakt","org.accessibility":"Erreichbarkeit","org.phone":"Telefon","org.email":"Email","org.opening_hours":"Öffnungszeiten","org.public_transports":"Öffentliche Verkehrsmittel in der Nähe","org.train":"Zug","org.tram":"Straßenbahn","org.bus":"Bus","people.title":"Personen","person.title":"Name der Person","person.create":"Person erstellen","person.name":"Name","person.saved":"Person {{name}} wurde gespeichert","person.firstname":"Vorname","person.lastname":"Nachname","person.function":"Funktion","person.select_or_create":"Person auswählen oder neuen Namen eintragen","person.nothing_found_create_new":"Keine Ergebnisse. [ENTER] legt diesen Namen an","person.created":"Person {{name}} wurde erstellt","person.show_edit_form":"Formular dieser Person anzeigen","person.unlink_from_entry":"Verknüpfung mit diesem Eintrag lösen",jobs:"Mitwirkende","jobs.add":"Neue Person/Funktion","jobs.no_yet":"Keine Funktionen definiert","job.description":"Funktion","job.saved":"Funktion {{name}} wurde gespeichert","job.author":"Autorenschaft","job.director":"Inszenierung","job.no_title":"Mitwirkende/r","venue.created":"Spielort {{name}} wurde angelegt","ensemble.select_or_create":"Ensemble auswählen oder neuen Namen eintragen","ensemble.nothing_found_create_new":"Keine Ergebnisse. [ENTER] legt diesen Namen an","ensemble.created":"Ensemble {{name}} wurde erstellt","ensemble.show_edit_form":"Formular dieses Ensembles anzeigen","ensemble.unlink_from_entry":"Verknüpfung mit diesem Eintrag lösen","error.missing_title":"Titel muss vor dem Fortfahren ausgefüllt werden.","error.missing_firstname":"Vorname muss vor dem Fortfahren ausgefüllt werden."};for(var b in a)Em.I18n.translations[b]=a[b]}}.call(),function(){"use strict";if("en"===currentLang){var a={"nav.overview":"Overview","nav.entries":"Entries","nav.organizations":"Venues / Ensembles","nav.people":"People","nav.settings":"Settings",lineup_overview:"Line up overview","entries.export":"Export your lineup","entries.title":"Line up entries",only_future:"Only future events","entry.title":"Title","entry.adv_settings":"Advanced settings","entry.last_changes":"Latest changes","entry.notify_creator_on_change":"Notify owner when entry is changed by someone else","entry.labels":"Labels","entry.currently_labeled":"is currently labeled with","entry.available_labels":"Available labels","entry.no_labels":"No label","entry.click_label":"Click a label below to mark this entry with it","entry.video_id":"Embedded video ID","entry.video_provider":"Embedded video provider","entry.subtitle":"Subtitle","entry.date":"Date","entry.venues":"Venue(s)","entry.create":"Create new line up entry","entry.description":"Description","entry.meta_keywords":"Keywords","entry.author":"Author","entry.director":"Director","entry.keywords":"Keywords","entry.save_before_content":"Save your content first before starting to upload images","entry.concessions":"Concessions","entry.book_email":"Booking email address","entry.book_phone":"Booking info phone","entry.book_url":"Booking link","entry.note":"Note","entry.function":"Function","entry.marketing_adv":"Marketing / Advanced","entry.orig_project_url":"Original project URL","entry.orig_project_url_desc":"e.g.: http://example.com/path/to/project","entry.vimeo":"Vimeo (http://vimeo.com)","entry.youtube":"Youtube (http://youtube.com)","entry.linked_media_placeholder":"e.g.: 6ddpV1GvF7E","entry.youtube_desc":"Just copy and paste the ID part of the youtube video you wish to use here. if your video link is: http://www.youtube.com/watch?v=6ddpV1GvF7E the 66dpV1GvF7E part is the ID of your video","entry.vimeo_desc":"Just copy and paste the ID part of the vimeo video you wish to use here. if your video link is: http://vimeo.com/92688138 the 92688138 part is the ID of your video","entry.video_switch":"Click the icon of your video provider to switch","entry.premiere":"Premiere","entry.derniere":"Derniere","entry.cancelled":"Cancelled","entry.festival":"Festival","entry.select_festival":"Select a festival (or create a new one)","entry.no_festival_found_create_new":"No festival found (create new?)","festival.created":"Festival {{name}} has been created","entry.draft":"Draft","entry.published":"Published","entry.marked_published":"{{name}} is now published","entry.marked_draft":"{{name}} is no longer published and marked as draft","entry.ttp":"Theatre / Dance / Performance","entry.youth":"Young audience","entry.cab":"Cabaret","entry.fes":"Festival","entry.category":"Category","entry.duration":"Duration","entry.breaks":"Breaks","entry.from_age_of":"From","entry.years":"years","entry.filename":"Filename / Part of Internet address","entry.press_voices":"Press voices","entry.media":"Media","entry.saved":"Entry {{name}} has been saved","entry.saving_failed":"Entry {{name}} failed to save","entry.deleted":"Entry {{name}} has been deleted","entry.really_delete":"Really delete {{name}}?","entry.ensembles":"Ensembles","entries.search":"Search","entries.search.quick":"Quick search","entries.search.advanced":"Advanced search",events:"Events","events.add":"Add event","event.no_yet":"No event yet","event.starts_placeholder":"YYYY-MM-DD","event.starts_time_placeholder":"HH:MM","event.select_venue":"Select a venue or enter new name","event.edit_prices":"Edit prices","event.nothing_found_create_new":"No results. Press Enter to create venue","event.saved":"Event {{starts}} has been saved","event.venue_required":"Venue is required in order to save event","event.person_required":"Please select a person","org.created":"Venue {{name}} has been created","org.contact":"Contact","org.type":"Type","org.type.venue":"Venue","org.type.ensemble":"Ensemble","org.type.organizer":"Organizer","org.title":"Venues","org.create":"Create a new venue","org.name":"Name","org.country":"Country","org.city":"City","org.address":"Address","org.saved":"Organization {{name}} has been saved","org.orig_org_url":"Link to website","org.accessibility":"Accessibility","org.phone":"Phone","org.email":"Email","org.opening_hours":"Opening hours","org.public_transports":"Public transports nearby","org.train":"Train","org.tram":"Tram","org.bus":"Bus","people.title":"People","person.title":"Person name","person.create":"Create person","person.name":"Name","person.saved":"Person {{name}} has been saved","person.firstname":"Firstname","person.lastname":"Lastname","person.function":"Function","person.select_or_create":"Select or create person","person.nothing_found_create_new":"No person matched your search. Enter to create","person.created":"Person {{name}} has been created","person.show_edit_form":"Show form of this person","person.unlink_from_entry":"Unlink person from this entry",jobs:"Team / Jobs","jobs.add":"Add a job","jobs.no_yet":"There is no job yet","job.description":"Job description","job.saved":"Job for {{name}} has been saved","job.author":"Playwright","job.director":"Directing","job.no_title":"crew member","ensemble.select_or_create":"Select or create ensemble","ensemble.nothing_found_create_new":"No ensemble matched your search. Enter to create","ensemble.created":"Ensemble {{name}} has been created","ensemble.show_edit_form":"Show form of ensemble","ensemble.unlink_from_entry":"Unlink ensemble from this entry","venue.created":"Venue {{name}} has been created","error.missing_title":"Title must be filled in before you can continue","error.missing_firstname":"Firstname must be filled in before you can continue"};
for(var b in a)Em.I18n.translations[b]=a[b]}}.call(),function(){"use strict";App.LineupEntry=DS.Model.extend({type:DS.attr("string",{defaultValue:"ttp"}),requestReviewBy:DS.belongsTo("user"),requestReviewMsg:DS.attr(),status:DS.attr("string",{defaultValue:"draft"}),translations:DS.hasMany("translation",{embedded:"always"}),categories:DS.attr("array"),lineup_jobs:DS.hasMany("lineup_job",{embedded:"always"}),labels:DS.hasMany("label",{async:!1,embedded:"keys"}),recommendedAge:DS.attr("number"),durationMin:DS.attr("number"),numBreaks:DS.attr("number"),notifyCreatorOnChange:DS.attr("boolean",{defaultValue:!0}),filename:DS.attr("string"),age:DS.attr("number"),lineup_events:DS.hasMany("lineup_event",{embedded:"always",inverse:"lineup_entry"}),ensembles:DS.hasMany("lineup_org",{embedded:"keys"}),organizers:DS.hasMany("lineup_org"),venues:function(){var a=[],b=[];return this.get("lineup_events").forEach(function(c){c.get("lineup_org")&&b.indexOf(c.get("lineup_org.id"))<0&&(a.push(c.get("lineup_org")),b.push(c.get("lineup_org.id")))}),a}.property("lineup_events.@each"),extRefId:DS.attr("string"),extRefSrc:DS.attr("string"),extRefNote:DS.attr("string"),extRefSyncAt:DS.attr("date"),origProjectUrl:DS.attr("string"),videoId:DS.attr("string"),videoIdTransformer:function(){this.get("videoId")&&(this.get("videoId").indexOf("?v=")>0?(this.set("videoId",this.get("videoId").split("?v=")[1]),this.set("videoProvider","youtube")):this.get("videoId").indexOf("vimeo.com/")>=0&&(this.set("videoId",this.get("videoId").split("vimeo.com/")[1]),this.set("videoProvider","vimeo")))}.observes("videoId"),videoProvider:DS.attr("string",{defaultValue:"youtube"}),createdBy:DS.belongsTo("user"),createdAt:DS.attr("date"),updatedBy:DS.belongsTo("user"),updatedAt:DS.attr("date"),othersWrite:DS.attr("boolean",{defaultValue:!0}),notifyMeOnWrite:DS.attr("boolean",{defaultValue:!0}),name:function(){return this.get("title")}.property("title"),usedLocales:function(){var a=this.get("translations").map(function(a){return a.locale}).join(",");return a.length<1?Em.I18n.t("translation.no"):void 0}.property("translations"),isPublished:function(){return"published"===this.get("status")}.property("status"),inReview:function(){return"review"===this.get("status")}.property("status"),isDraft:function(){return"draft"===this.get("status")}.property("status"),curTranslation:function(){return this.get("translations").findBy("locale",App._curLang)}.property("translations.@each","App._curLang"),previewLink:function(){var a="http://"+currentDomain.fqdn+"/drafts/"+this.get("id")+".htm";return this.get("translations").content.length>1&&(a+="."+this.get("curLang")),a}.property("id"),isOwner:function(){return currentUser.superuser||this.get("createdBy.id")===currentUser._id||currentDomain._id in currentUser.roles&&currentUser.roles[currentDomain._id]>=80}.property("createdBy"),isFestival:function(){return this.get("categories").indexOf("festival")>=0}.property("categories")}),Ember.Inflector.inflector.irregular("lineupEntry","lineup_entries")}(App),function(){"use strict";App.LineupEvent=DS.Model.extend({starts:DS.attr("date",{defaultValue:moment().hour(20).minutes(0).seconds(0).toDate()}),lineup_org:DS.belongsTo("lineup_org"),festival:DS.belongsTo("lineup_entry"),lineup_entry:DS.belongsTo("lineup_entry"),premiere:DS.attr("boolean",{defaultValue:!1}),derniere:DS.attr("boolean",{defaultValue:!1}),cancelled:DS.attr("boolean",{defaultValue:!1}),note:DS.attr(),bookPhone:DS.attr(),bookEmail:DS.attr(),bookUrl:DS.attr(),concessions:DS.attr("array"),startsDate:function(a,b){var c=moment(this.get("starts"));return 2===arguments.length&&b.match(/(\d\d\d\d)-(\d\d)-(\d\d)/)&&this.set("starts",moment(b+" "+c.format("HH:mm")).toDate()),moment(this.get("starts")).format("YYYY-MM-DD")}.property("starts"),startsTime:function(a,b){var c=moment(this.get("starts"));return 2===arguments.length&&b.match(/(\d\d):(\d\d)/)&&this.set("starts",moment(c.format("YYYY-MM-DD")+" "+b).toDate()),moment(this.get("starts")).format("HH:mm")}.property("starts")}),Ember.Inflector.inflector.irregular("lineupEvent","lineup_events")}(App),function(){"use strict";App.LineupJob=DS.Model.extend({title:DS.attr("string"),lineup_person:DS.belongsTo("lineup_person"),name:function(){return this.get("lineup_person.name")}.property("lineup_person"),isAuthor:function(){return this.get("title")&&this.get("title").toLowerCase().match(/author|autor|playwright/)}.property("title"),isDirector:function(){return this.get("title")&&this.get("title").toLowerCase().match(/director|regie|regisseur|inszenierung|mis en scene/)}.property("title")}),Ember.Inflector.inflector.irregular("lineupJob","lineup_jobs")}(App),function(){"use strict";App.LineupOrg=DS.Model.extend({type:DS.attr("string",{defaultValue:"venue"}),status:DS.attr("string",{defaultValue:"published"}),translations:DS.hasMany("translation",{embedded:"always"}),curTranslation:function(){return this.get("translations").findBy("locale",App._curLang)}.property("translations.@each"),labels:DS.hasMany("label",{async:!1,embedded:"keys"}),street:DS.attr("string"),zip:DS.attr("string"),city:DS.attr("string"),gkz:DS.attr("string"),country:DS.attr("string",{defaultValue:"AT"}),state:DS.attr("string"),members:DS.hasMany("lineup_person"),origUrl:DS.attr("string"),extRefId:DS.attr("string"),extRefSrc:DS.attr("string"),extRefNote:DS.attr("string"),extRefSyncAt:DS.attr("date"),openingHours:DS.attr("string"),reachByBus:DS.attr("string"),reachByTram:DS.attr("string"),reachByTrain:DS.attr("string"),email:DS.attr("string"),phone:DS.attr("string"),extUrl:DS.attr("string"),videoUrl:DS.attr("string"),videoUrlType:DS.attr("string"),createdBy:DS.belongsTo("user"),createdAt:DS.attr("date"),updatedBy:DS.belongsTo("user"),updatedAt:DS.attr("date"),othersWrite:DS.attr("boolean",{defaultValue:!0}),notifyMeOnWrite:DS.attr("boolean",{defaultValue:!0}),usedLocales:function(){var a=this.get("translations").map(function(a){return a.locale}).join(",");return a.length<1?Em.I18n.t("translation.no"):void 0}.property("translations"),isPublished:function(){return"published"===this.get("status")}.property("status"),isDraft:function(){return"draft"===this.get("status")}.property("status"),isVenue:function(){return"venue"===this.get("type")}.property("type"),isEnsemble:function(){return"ensemble"===this.get("type")}.property("type"),isOrganizer:function(){return"organizer"===this.get("type")}.property("type")}),Ember.Inflector.inflector.irregular("lineupOrg","lineup_orgs")}(App),function(){"use strict";App.LineupPerson=DS.Model.extend({status:DS.attr("string",{defaultValue:"published"}),translations:DS.hasMany("translation",{embedded:"always"}),tags:DS.attr("array"),labels:DS.hasMany("label",{async:!1,embedded:"keys"}),firstname:DS.attr("string"),lastname:DS.attr("string"),midname:DS.attr("string"),email:DS.attr("string"),phone:DS.attr("string"),street:DS.attr("string"),zip:DS.attr("string"),city:DS.attr("string"),gkz:DS.attr("string"),country:DS.attr("string",{defaultValue:"AT"}),state:DS.attr("string"),extRefId:DS.attr("string"),extRefSrc:DS.attr("string"),extRefNote:DS.attr("string"),extRefSyncAt:DS.attr("date"),extUrl:DS.attr("string"),videoUrl:DS.attr("string"),videoUrlType:DS.attr("string"),createdBy:DS.belongsTo("user"),createdAt:DS.attr("date"),updatedBy:DS.belongsTo("user"),updatedAt:DS.attr("date"),othersWrite:DS.attr("boolean",{defaultValue:!0}),notifyMeOnWrite:DS.attr("boolean",{defaultValue:!0}),usedLocales:function(){var a=this.get("translations").map(function(a){return a.locale}).join(",");return a.length<1?Em.I18n.t("translation.no"):void 0}.property("translations"),isPublished:function(){return"published"===this.get("status")}.property("status"),isDraft:function(){return"draft"===this.get("status")}.property("status"),name:function(a,b){b&&(this.set("firstname",b),b.split(" ").length>1&&(this.set("firstname",b.split(" ")[0]),this.set("lastname",b.replace(b.split(" ")[0],""))));var c="";return this.get("firstname")&&this.get("firstname").length>0&&(c+=this.get("firstname")),c.length>0&&this.get("lastname")&&this.get("lastname").length>0&&(c+=" "),this.get("lastname")&&this.get("lastname").length>0&&(c+=this.get("lastname")),c}.property("firstname","lastname"),curTranslation:function(){return this.get("translations").findBy("locale",App._curLang)}.property("translations.@each","App._curLang")}),Ember.Inflector.inflector.irregular("lineupPerson","lineup_people"),Ember.Inflector.inflector.irregular("lineup_person","lineupPeople")}(App),function(a){"use strict";a.Price=DS.Model.extend({name:DS.attr("string"),description:DS.attr("string"),note:DS.attr("string"),limited:DS.attr("number"),price:DS.attr("number"),reductions:DS.hasMany("reduction",{embedded:"always"}),vat:DS.attr("number"),priceIncl:function(){var a=isNaN(this.get("price"))?0:parseFloat(this.get("price")),b=this.get("vat");return console.log("price is",a,b),(a+a*b*.01).toFixed(2)}.property("vat","price"),observeIncl:function(){var a=isNaN(this.get("priceIncl"))?0:this.get("priceIncl"),b=this.get("vat"),c=a/(100+b),d=100*c;console.log("observer vat",b,"perc1",c,"perc100",d),this.set("price",d.toFixed(2))}.observes("priceIncl"),priceExcl:function(){var a=isNaN(this.get("price"))?0:parseFloat(this.get("price"));return a.toFixed(2)}.property("vat","price"),formattedPrice:function(){var b=this.get(a._shopSettings.get("grossInt")?"priceIncl":"priceExcl");return"de"===currentUser.lang&&(b=b.replace(".",",")),new Handlebars.SafeString(b+" "+caminio.util.currencyCode2Symbol(a._shopSettings.get("currency")))}.property("price")}),a.Reduction=a.Price.extend()}(App),function(a){"use strict";function b(a){var b='<form class="bootbox-form"><div class="form-group row"><input type="text" value="'+(a.get("name")||"")+'" autocomplete="off" class="bootbox-input bootbox-input-text form-control name col-md-12"></div><div class="row margin-top clearfix colors"><label class="control-label col-md-3">'+Em.I18n.t("label.select_color")+'</label><div class="col-md-9">'+caminio.labels.getColors()+'</div></div><div class="row margin-top clearfix colors"><label class="control-label col-md-3">'+Em.I18n.t("label.private")+'</label><div class="col-md-9"><input type="checkbox" class="private"></div></div></form>';return b}a.Router.map(function(){this.resource("lineup_entries"),this.resource("lineup_entries.edit",{path:"/lineup_entries/edit/:id"}),this.resource("lineup_entries.new",{path:"/lineup_entries/new"}),this.resource("lineup_orgs"),this.resource("lineup_orgs.edit",{path:"/lineup_org/edit/:id"}),this.resource("lineup_orgs.new",{path:"/lineup_org/new"}),this.resource("lineup_people"),this.resource("lineup_people.edit",{path:"/lineup_person/edit/:id"}),this.resource("lineup_people.new",{path:"/lineup_person/new"})}),a.IndexRoute=Ember.Route.extend({redirect:function(){this.transitionTo("lineup_entries")}}),a.set("_defaultJobs",domainSettings.lineupDefaultJobs),a.set("_availableFestivals",Em.A()),a.LineupEntriesRoute=Ember.Route.extend({model:function(){var b={"lineup_events.starts":"gteDate("+moment().startOf("day").toISOString()+")"};return a.get("emberUser.isTrusted")||(b.createdBy=a.get("emberUser.id")),this.store.find("lineup_entry",b)},setupController:function(a,b){var c=this.controllerFor("lineup_entries_table");c.set("model",b)},renderTemplate:function(){this.render(),this.render("lineup_entries.table",{into:"lineup_entries",outlet:"table",controller:"lineup_entries_table"})}}),a.LineupEntriesNewRoute=Ember.Route.extend({model:function(){var a=domainSettings.lineupDefaultCategories||[];return this.store.createRecord("lineup_entry",{categories:a})},setupController:function(a,b){a.set("model",b),a._createTr(b)}}),a.LineupEntriesEditRoute=Ember.Route.extend({model:function(a,b){return this.store.find("lineup_entry",b.params.id)},setupController:function(a,b){this.store.find("mediafile",{parent:b.get("id"),order:"position:asc"}).then(function(b){a.set("mediafiles",b)}),this.store.all("lineup_org").forEach(function(b){"venue"===b.get("type")?a.get("availableVenues").pushObject(b):"ensemble"===b.get("type")&&a.get("availableEnsembles").pushObject(b)}),this.store.all("lineup_person").forEach(function(b){a.get("availablePeople").pushObject(b)}),a.set("model",b)},actions:{editMediafileModal:function(a){var b=this.controllerFor("mediafile_editor");b.set("model",a),b.set("curRoute",this),this.render("mediafile_editor",{into:"lineup_entries.edit",outlet:"modal"})},closeModal:function(a){a&&this.get("controller.mediafiles").removeObject(a),this.disconnectOutlet({outlet:"modal",parentView:"lineup_entries.edit"})}}}),a.LineupOrgsRoute=Ember.Route.extend({setupController:function(){var a=this.controllerFor("lineup_orgs_table");a.set("model",this.store.all("lineup_org"))},renderTemplate:function(){this.render(),this.render("lineup_orgs.table",{into:"lineup_orgs",outlet:"table",controller:"lineup_orgs_table"})}}),a.LineupOrgsNewRoute=Ember.Route.extend({model:function(){return this.store.createRecord("lineup_org")},setupController:function(a,b){a.set("model",b),a._createTr(b)}}),a.LineupOrgsEditRoute=Ember.Route.extend({beforeModel:function(){return this.store.find("lineup_org")},model:function(a,b){return this.store.find("lineup_org",b.params.id)},setupController:function(a,b){this.store.find("mediafile",{parent:b.get("id"),order:"position:asc"}).then(function(b){a.set("mediafiles",b)}),a.set("model",b)},actions:{editMediafileModal:function(a){var b=this.controllerFor("mediafile_editor");b.set("model",a),b.set("curRoute",this),this.render("mediafile_editor",{into:"lineup_orgs.edit",outlet:"modal"})},closeModal:function(a){a&&this.get("controller.mediafiles").removeObject(a),this.disconnectOutlet({outlet:"modal",parentView:"lineup_orgs.edit"})}}}),a.LineupPeopleRoute=Ember.Route.extend({setupController:function(){var a=this.controllerFor("lineup_people_table");a.set("model",this.store.all("lineup_person"))},renderTemplate:function(){this.render(),this.render("lineup_people.table",{into:"lineup_people",outlet:"table",controller:"lineup_people_table"})}}),a.LineupPeopleNewRoute=Ember.Route.extend({model:function(){return this.store.createRecord("lineup_person")},setupController:function(a,b){a.set("model",b),a._createTr(b)}}),a.LineupPeopleEditRoute=Ember.Route.extend({beforeModel:function(){return this.store.find("lineup_person")},model:function(a,b){return this.store.find("lineup_person",b.params.id)},setupController:function(b,c){c.get("curTranslation")||c.get("translations").pushObject(this.store.createRecord("translation",{locale:a._curLang,content:""})),this.store.find("mediafile",{parent:c.get("id"),order:"position:asc"}).then(function(a){b.set("mediafiles",a)}),b.set("model",c)},actions:{editMediafileModal:function(a){var b=this.controllerFor("mediafile_editor");b.set("model",a),b.set("curRoute",this),this.render("mediafile_editor",{into:"lineup_people.edit",outlet:"modal"})},closeModal:function(a){a&&this.get("controller.mediafiles").removeObject(a),this.disconnectOutlet({outlet:"modal",parentView:"lineup_people.edit"})}}}),a.ApplicationRoute=Em.Route.extend({beforeModel:function(){function b(b){c.store.find("user").then(function(){c.store.find("lineup_org").then(function(){c.store.find("lineup_entry",{categories:"festival"}).then(function(d){d.forEach(function(b){a.get("_availableFestivals").pushObject(b)}),c.store.find("lineup_person").then(function(){c.store.find("label",{type:"lineup"}).then(function(c){a.set("_availableLabels",c),b()})})})})})}var c=this,d=new Ember.RSVP.Promise(b);return d},actions:{editLabel:function(c){function d(){var a=$(this);a.find("form").on("submit",function(b){b.preventDefault(),f(),a.modal("hide")}),setTimeout(function(){a.find("input[type=text]:first").focus()},500),a.find(".color").on("click",function(){a.find(".color").removeClass("active"),$(this).addClass("active")}),a.find("input[type=checkbox]").attr("checked",c.get("private")),a.find(".color[data-bg-color="+c.get("bgColor")+"]").addClass("active")}function e(){c.isDirty&&c.deleteRecord()}function f(){var a=$(".bootbox .color.active");a.length||(a=$(".bootbox .color:first").addClass("active")),c.set("bgColor",a.attr("data-bg-color")),c.set("fgColor",a.attr("data-fg-color")),c.set("borderColor",a.attr("data-border-color"));var b=h.getById("user",currentUser._id);$(".bootbox .private").is(":checked")?c.get("usersAccess").pushObject(b):c.get("usersAccess").removeObject(b),c.set("name",$(".edit-label-modal .name").val()),g()}function g(){var b=c.id?!1:!0;c.save().then(function(c){b?(notify("info",Em.I18n.t("label.created",{name:c.get("name")})),a.get("_availableLabels").pushObject(c)):notify("info",Em.I18n.t("label.saved",{name:c.get("name")}))}).catch(function(a){console.error(a),notify("error",a)})}var h=this.store;c||(c=h.createRecord("label",{type:"lineup"})),bootbox.dialog({title:Em.I18n.t("name"),message:b(c),className:"edit-label-modal",buttons:{save:{label:Em.I18n.t("save"),className:"primary",callback:f}}}).on("shown.bs.modal",d).on("hide.bs.modal",e)}}}),a.ApplicationView=Em.View.extend({didInsertElement:function(){setupCaminio(this.$())}}),a._curLang=currentDomain.lang}(App),function(a){"use strict";a.LineupEntriesEditView=Ember.View.extend({didInsertElement:function(){this.$("[data-toggle=popover]").popover({html:!0,trigger:"hover",placement:"bottom",delay:1e3,content:function(){return $("#"+$(this).attr("id")+"-content").html()}}),a.setupCtrlS(this.get("controller.content"),Em.I18n.t("entry.saved",{name:this.get("controller.content.curTranslation.title")})),this.$("input[type=text]:visible:first").focus()}}),a.LineupEntriesNewView=a.LineupEntriesEditView.extend()}(App),function(a){"use strict";a.LineupEntriesTableView=Ember.View.extend({didInsertElement:function(){$(this.$("table.caminio thead .sortable-asc")[3]).click()},removeLoader:function(){$(".caminio-table-wrapper").removeClass("loading")}.on("didInsertElement")})}(App),function(a){"use strict";a.LineupEventsListView=Ember.View.extend({templateName:"lineup_events/list",didInsertElement:function(){this.$().on("mouseenter",".datepicker",function(){$(this).hasClass("hasDatepicker")||$(this).datepicker({prevText:"",nextText:"",dateFormat:"yy-mm-dd"})}),this.$().on("mouseenter",".timepicker",function(){$(this).hasClass("hasTimepicker")||$(this).caminioTimepicker()})},willDestroyElement:function(){this.$(".datepicker").datepicker("destroy")}})}(App),function(a){"use strict";a.LineupJobsListView=Ember.View.extend({templateName:"lineup_jobs/list",didInsertElement:function(){var a=this;this.$(".jobs-list").sortable({revert:"invalid",handle:".move-job",update:function(){a.$(".job").each(function(){var b=a.get("controller").store.getById("lineup_job",$(this).attr("data-id"));a.get("controller.lineup_jobs").removeObject(b),a.get("controller.lineup_jobs").pushObject(b),a.get("controller.content").send("becomeDirty")})}})}})}(App),function(a){"use strict";function b(a,b,c){var d=[];c.find(".media-item").each(function(){$(this).attr("data-id")&&d.push($(this).attr("data-id"))}),$.post("/caminio/mediafiles/reorder/",{ids:d}).done(function(){notify("info",Em.I18n.t("files.new_order_saved"))})}a.LineupMediaView=Ember.View.extend({templateName:"lineup/media",didInsertElement:function(){var a=this.get("controller");this.$(".media-items").sortable({update:function(c,d){b(c,d,$(this),a.get("content"))}}),$("#fileupload").fileupload({dataType:"json",url:"/caminio/mediafiles",done:function(b,c){setTimeout(function(){$("#progress").removeClass("active")},1e3),a.store.pushPayload("mediafile",c.result),a.store.find("mediafile",{parent:a.get("model.id")}).then(function(b){a.set("mediafiles",b),setTimeout(function(){self.$(".media-items").sortable("refresh")},100)})},progressall:function(a,b){$("#progress").addClass("active");var c=parseInt(b.loaded/b.total*100,10);$("#progress .progress-bar").css("width",c+"%").attr("aria-valuenow",c).find(".perc-text").text(c+"%")}}).on("fileuploadsubmit",function(b,c){c.formData={parent:a.get("model.id")||null,parentType:"LineupEntry"}})}})}(App),function(a){"use strict";a.LineupOrgsEditView=Ember.View.extend({didInsertElement:function(){a.setupCtrlS(this.get("controller.content"),Em.I18n.t("org.saved",{name:this.get("controller.content.curTranslation.title")})),this.$("input[type=text]:visible:first").focus()}}),a.LineupOrgsNewView=a.LineupOrgsEditView.extend()}(App),function(a){"use strict";a.LineupPeopleEditView=Ember.View.extend({didInsertElement:function(){a.setupCtrlS(this.get("controller.content"),Em.I18n.t("person.saved",{name:this.get("controller.content.name")})),this.$("input[type=text]:visible:first").focus()}}),a.LineupPeopleNewView=a.LineupPeopleEditView.extend()}(App);