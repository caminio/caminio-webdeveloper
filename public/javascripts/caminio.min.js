/*! caminio-ui 2014-07-01 
* Copyright (c) 2014 TASTENWERK 
* Available via the MIT license.
* see: http://opensource.org/licenses/MIT for blueprint.
*/
(function(){"use strict";if("de"===currentLang){var a={de:"Deutsch",en:"Englisch",hi:"Hi",or:"oder",at:"um",ago:"vor",sign_out:"Abmelden",edit_profile:"Profil bearbeiten",other_domains:"Andere Organisationen",change_password:"Passwort ändern",only_mine:"Nur meine",go_to_dashboard:"zum Dashboard gehen",go_to_calendar:"zum Kalendar gehen","apps.settings":"Einstellungen","apps.domains":"Domänen","apps.lineup":"Spielplan","apps.webmaker":"WebMaker","apps.shop":"Shop","apps.people":"Kontakte","apps.calendar":"Kalender","apps.open_app_bar":"Anwendungsleiste öffnen, auch: Taste [c]","apps.profile":"Profil",today_is:"Heute ist",today:"Heute",yesterday:"Gestern",tomorrow:"Morgen",last_login:"Letztes Mal online",live_ticker:"Live Ticker","live_ticker.post":"Abschicken","live_ticker.something_to_say":"Notiz oder Nachricht schreiben","live_ticker.message":"Nachricht","live_ticker.media":"Fotos / Dateien",name:"Name",title:"Titel",filename:"Dateiname",save:"Speichern",back:"Zurück",edit:"Bearbeiten",show:"Anzeigen",close:"Schließen",done:"Fertig",cancel:"Abbrechen",create:"Erstellen",remove:"Löschen","delete":"Löschen",undo:"Rückgängig",delete_selected:"Ausgewählte löschen",root:"Wurzel",actions:"Aktionen",preview:"Vorschau",more:"mehr",perc_completed:"Prozent abgeschlossen",status:"Status",total:"Gesamt",adv_search:"Erweiterte Suche",o_clock:"Uhr",email:"Email",phone:"Telefon",address:"Adresse",street:"Straße",zip:"PLZ",state:"Bundesland",country:"Land",city:"Stadt",cut:"Ausschneiden",copy:"Bearbeiten",paste:"Einfügen",properties:"Eigenschaften",date:"Datum",time:"Zeit",select_all:"Alle auswählen",upload_file:"Hochladen",published:"veröffentlicht",draft:"Entwurf",published_click_to_change:"veröffentlicht - klicken, um den Status zu ändern",draft_click_to_change:"Entwurf - klicken, um den Status zu ändern",user_activity:"Aktivität",disk_quota:"Festplatte",users_quota:"Benutzerkonten",latest_activities:"Letzte Aktivitäten",users_in_total:"BenutzerInnen gesamt",please_select:"Bitte auswählen...",select_country:"Land auswählen...",settings:"Einstellungen",required_fields:"Erfordert Eingabe",last_modified:"geändert",created:"erstellt",created_by:"erstellt von",created_at:"erstellt am",updated:"aktualisiert",updated_by:"aktualisiert von",updated_at:"aktualisiert am",unsaved_data_continue:"Das Formular enthält ungespeicherte Daten. Wirklich fortfahren?",labels:"Labels","labels.title":"Labels","labels.new":"Neues Label","labels.select_entries_then_click_on_label":"Zuerst Einträge auswählen, um sie mit einem Label zu markieren","labels.items_selected":"{{count}} Einträge zu Label hinzufügen","labels.no_labels":"Keine Labels gesetzt","labels.click":"Auf ein Label klicken um dieses Element damit zu verknüpfen","label.created":"Label {{name}} wurde erfolgreich angelegt","label.saved":"Einstellungen {{name}} wurden gespeichert","label.delete":"Dieses Label löschen","label.really_delete":"{{name}} wirklich löschen","label.deleted":"Label {{name}} wurde gelöscht","label.private":"Privat","label.select_color":"Farbe wählen","translation.title":"Sprache",content_here:"Hier sollte noch Text eingetragen werden!","errors.db_field":"{{name}}: {{message}}","errors.required":"Eingabe erforderlich","errors.invalid_email_address":"Ungültige Email Adresse","errors.duplicate_key":"{{name}} existiert bereits und darf nicht doppelt vorkommen",really_delete:"{{name}} wirklich löschen","pic.drop_here":"Hochladen"};for(var b in a)Em.I18n.translations[b]=a[b]}}).call(),function(){"use strict";if("en"===currentLang){var a={de:"Deutsch",en:"English",hi:"Hi",or:"or",at:"at",ago:"ago",sign_out:"Sign out",edit_profile:"Edit profile",other_domains:"Other domains",change_password:"Change password",only_mine:"Only mine",go_to_dashboard:"go to dashboard",go_to_calendar:"go to calendar","apps.settings":"Settings","apps.domains":"Domains","apps.lineup":"Line-up","apps.web":"WebMaker","apps.shop":"Shop","apps.people":"Contacts","apps.calendar":"Calendar","apps.open_app_bar":"Open app panel, also with: shortcut [c]","apps.profile":"Profile",today_is:"Today is",today:"today",yesterday:"Yesterday",tomorrow:"tomorrow",last_login:"Last login",live_ticker:"Live ticker","live_ticker.post":"Post","live_ticker.something_to_say":"Write a note or message","live_ticker.message":"Message","live_ticker.media":"Pictures / files",name:"Name",title:"Title",filename:"Filename",save:"Save",back:"Back",edit:"Edit",show:"Show",close:"Close",done:"Done",cancel:"Cancel",create:"Create",remove:"Remove","delete":"Delete",undo:"Undo",delete_selected:"Delete selected",root:"root",actions:"Actions",preview:"Preview",more:"more",perc_completed:"percent completed",status:"Status",total:"Total",adv_search:"Advanced search",o_clock:"o'clock",cut:"Cut",copy:"Copy",paste:"Paste",email:"Email",phone:"Phone",address:"Address",street:"Street",zip:"Zip",state:"State",country:"Country",city:"City",properties:"properties",date:"Date",time:"Time",select_all:"Select all",upload_file:"Upload a file",published:"published",draft:"draft",published_click_to_change:"published - click to change status",draft_click_to_change:"draft - click to change status",user_activity:"User activity",disk_quota:"Disk Quota",users_quota:"Users",latest_activities:"Latest activities",users_in_total:"Users in total",please_select:"Please select...",select_country:"Select country...",required_fields:"Required field",last_modified:"Modified",created:"Created",created_by:"Created by",created_at:"Created at",updated:"Updated",updated_by:"Updated by",updated_at:"Updated at",settings:"Settings",unsaved_data_continue:"The opened form contains unsaved data which would be lost. Really continue?",labels:"Labels","labels.title":"Labels","labels.new":"New label","labels.select_entries_then_click_on_label":"Select one or more items then click on the label to add them","labels.items_selected":"label {{count}} items with","labels.no_labels":"No labels set","labels.click":"Click a label to mark this element with it",content_here:"Here should go some text!","translation.title":"Language","label.created":"Label {{name}} has been created successfully","label.saved":"Label settings for {{name}} have been saved successfully","label.delete":"Delete this label","label.really_delete":"Really delete label {{name}}","label.deleted":"Label {{name}} has been deleted successfully","label.private":"Private","label.select_color":"Select color","errors.db_field":"{{name}}: {{message}}","errors.required":"This field is required","errors.invalid_email_address":"The email address is invalid","errors.duplicate_key":"{{name}} is duplicate and can't be saved twice",really_delete:"Really delete label {{name}}","pic.drop_here":"Upload"};for(var b in a)Em.I18n.translations[b]=a[b]}}.call(),function(){"use strict";function a(a){for(var b="abcdefghijklnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",c="",d=0,e=b.length;a>d;++d)c+=b.charAt(Math.floor(Math.random()*e));return c}function b(c){var d=a(c),e="!$#-_?|><",f=Math.floor(Math.random()*e.length),h=Math.floor(Math.random()*c),i=d.substring(0,h-1)+e.charAt(f)+d.substring(h+1,c-1);return g.test(i)?i:b(c)}function c(){$(function(){$("[data-translate]").each(function(){$(this).text(Ember.I18n.t($(this).attr("data-translate")))}),$("[data-translate-title]").each(function(){$(this).attr("title",Ember.I18n.t($(this).attr("data-translate-title")))})})}function d(a){switch(a){case"EUR":return"&euro;";case"GBP":return"&#163;";case"USD":return"$"}}function e(a,b){for(b=b||5,a=a.toString();a.length<b;)a="0"+a;return a}function f(a){var b=a;return 0!=b.indexOf("http")&&(b="http://"+a),"/"===b[b.length-1]?b.substring(0,b.length-2):b}window.caminio=window.caminio||{},window.caminio.uid=a,window.caminio.generatePassword=b,window.caminio.translateDataFields=c,window.caminio.util=window.caminio.util||{},window.caminio.generatePassword=b,window.caminio.translateDataFields=c,window.caminio.util.uid=a,window.caminio.util.generatePassword=b,window.caminio.util.translateDataFields=c,window.caminio.util.createNum=e,window.caminio.util.fqdnify=f,window.caminio.util.currencyCode2Symbol=d;var g=/(?=^[^\s]{6,128}$)((?=.*?\d)(?=.*?[A-Z])(?=.*?[a-z])|(?=.*?\d)(?=.*?[^\w\d\s])(?=.*?[a-z])|(?=.*?[^\w\d\s])(?=.*?[A-Z])(?=.*?[a-z])|(?=.*?\d)(?=.*?[A-Z])(?=.*?[^\w\d\s]))^.*/}(),function(a){"use strict";function b(a,b){if(this.createTextRange){var c=this.createTextRange();c.collapse(!0),c.moveStart("character",a),c.moveEnd("character",b-a),c.select()}else this.setSelectionRange&&(this.focus(),this.setSelectionRange(a,b))}function c(a){var b=this.value.length;if(a="start"==a.toLowerCase()?"Start":"End",document.selection){var c,d,e,f=document.selection.createRange();return c=f.duplicate(),c.expand("textedit"),c.setEndPoint("EndToEnd",f),d=c.text.length-f.text.length,e=d+f.text.length,"Start"==a?d:e}return"undefined"!=typeof this["selection"+a]&&(b=this["selection"+a]),b}a.fn.caminioTimepicker=function(){this.addClass("hasTimepicker"),a(this).on("keydown",function(b){var c=a(this).val();if(40===b.keyCode||38===b.keyCode){c=c.match(/\d\d:\d\d/)?c:"20:00";var d=parseInt(c.split(":")[0]),e=parseInt(c.split(":")[1]);40===b.keyCode?d-=1:38===b.keyCode&&(d+=1),d>23&&(d=0),0>d&&(d=23),d=d.toString(),d=d.length<2?"0"+d:d,e=e.toString(),e=e.length<2?"0"+e:e,a(this).val(d+":"+e)}})},a.fn.caminioPhonePicker=function(d){function e(c,d,e){a(this).val(f.regexp(c)),d&&e&&((4===d||6===d)&&(d=++e),b.apply(this,[d,e]))}var f=a.extend({regexp:function(a){return a=a.replace(/^00/,"+"),a=a.replace(/ /,""),a.length>9?a.replace(/([\d]{2})(\d{3})(\d{3})(\d{3})/,"$1 $2 $3 $4 "):a.length>6?a.replace(/([\d]{2})(\d{3})(\d{3})/,"$1 $2 $3 "):a.length>4?a.replace(/([\d]{2})(\d{3})/,"$1 $2 "):a.replace(/([\d]{2})/,"$1 ")}},d);this.on("keyup",function(a){var b=this.value,d=c.apply(this,["start"]),f=c.apply(this,["end"]);if(b=b.replace(/,/g,"."),32===a.keyCode)d-=1;else if(37===a.keyCode||39===a.keyCode||8===a.keyCode||46===a.keyCode)return;e.apply(this,[b,d,f])}),this.on("change",function(){e.apply(this,[this.value])})},a.fn.caminioNumberPicker=function(d){function e(a){return a.toFixed(g.decimals)}function f(c,d,f){isNaN(c)&&(c=0),c=e(parseFloat(c)).replace(".",g.point),a(this).val(c),d&&f&&b.apply(this,[d,f])}var g=a.extend({decimals:2,point:"."},d);this.on("keyup",function(a){var b=this.value,d=c.apply(this,["start"]),e=c.apply(this,["end"]);if(b=b.replace(/,/g,"."),188===a.keyCode||190===a.keyCode)b.split(".").length>1&&(b=b.replace(".",""));else if(37===a.keyCode||39===a.keyCode||8===a.keyCode||46===a.keyCode)return;f.apply(this,[b,d,e])}),this.on("change",function(){f.apply(this,[this.value])})}}(jQuery),$.fn.switchTabs=function(a){var b=($.extend({},a),$(this)),c=$(".switch-tabs-content[data-tabs-id="+$(this).attr("data-tabs-id")+"]");b.find("li").on("click",function(d){d.preventDefault(),$(this).hasClass("disabled")||(b.find("li").removeClass("active"),c.find("section").hide(),$(c.find("section")[$(this).index()]).show().addClass("active").find(".js-get-focus").focus(),$(this).addClass("active"),a&&"function"==typeof a.activate&&a.activate($(this)))});var d=b.find("li.active");d.length||(d=b.find("li:first")),d.click()},function(){function a(a){return inflection.underscore(a.constructor.toString()).replace("app._","")}Ember.Tree=Ember.Namespace.create(),Ember.Tree.BranchView=Ember.CollectionView.extend({tagName:"ul",classNames:["ember-tree"],itemViewClass:"Ember.Tree.NodeView",root:!0,addNewItem:function(){var a=this.get("controller.addedItem");if(this.get("root"))a.get("parent")||this.get("content").content.pushObject(a);else if(a.get("parent")&&this.get("parentView.content.id")===a.get("parent.id")){var b=this.get("parentView");b.get("children")?b.get("children").content.pushObject(a):(b.set("children",b._fetchChildren()),b.set("isOpen",!0))}}.observes("controller.addedItem"),deleteItem:function(){var a=this.get("controller.removedItem"),b=this.$("[data-id="+a.id+"]");b.length&&Ember.View.views[b.closest("li").attr("id")].destroy()}.observes("controller.removedItem"),didInsertElement:function(){function b(e,f,g){e.push(f);var h=f.get("parent.id")||f.get("parent");return h?void f.store.findById(a(f),h).then(function(a){b(e,a,g)}):setTimeout(function(){c(e,d)},1e3)}function c(a,b){a.forEach(function(e,f){var g=b.$("[data-id="+e.id+"]");if(!(g.length<1)){var h=Ember.View.views[g.closest("li").attr("id")];if(!h)throw new Error("view not found when trying to open node view in tree");1===a.length&&d.get("controller").send("treeItemSelected",e,!0),a.splice(f,1),h.set("isOpen",!0);var i=h._fetchChildren();h.set("children",i),i.then(function(){setTimeout(function(){c(a,b)},1)})}})}this.nearestWithProperty("root")&&this.set("root",!1);this.get("controller");this.get("adaptHeightElem")&&this.$().closest(".box").css({maxHeight:$(this.get("adaptHeightElem")).height()-20,overflow:"auto"});var d=this;this.get("selectItem")&&b([],this.get("selectItem"))},_getRootView:function(){return this.nearestWithProperty("root")?this.nearestWithProperty("root")._getRootView():this}}),Ember.Tree.NodeView=Ember.View.extend({isOpen:!1,children:null,tagName:"li",isSelected:function(){return this.get("controller.curSelectedItem.id")===this.get("content.id")}.property("controller.curSelectedItem"),hasChildren:function(){return null===this.get("children")||this.get("children.content")&&this.get("children.content").content.length>0}.property("children.content"),classNameBindings:[":ember-tree-node","isOpen: tree-branch-open","hasChildren:tree-branch-icon:tree-node-icon"],didInsertElement:function(){var a=this;this.$().draggable({handle:".move",helper:"clone",revert:function(b){if(b)return!0;var c=a.get("controller.draggingNodeView.parentView.parentView"),d=App.User.store.getById("webpage",a.$(".item-container").attr("data-id"));d.set("parent",App.User.store.createRecord("webpage")),d.save().then(function(){c&&"_fetchChildren"in c&&c.set("children",c._fetchChildren()),notify("info",Em.I18n.t("webpage.moved_to",{name:a.get("name"),to:Em.I18n.t("root")}));var b=a.nearestWithProperty("root")._getRootView();b.get("content.content").pushObject(d)})},start:function(){a.get("controller").set("draggingNodeView",a)},stop:function(){a.get("controller.draggingNodeView")&&a.get("controller").set("draggingNodeView",null)}}).droppable({accept:".ember-tree li",greedy:!0,hoverClass:"droppable-candiate",drop:function(b,c){b.stopPropagation();var d=c.draggable.find(".item-container").attr("data-id"),e=Ember.View.views[c.draggable.attr("id")],f=App.User.store.getById(a._modelName(),d);f.set("parent",a.get("content")),e&&"destroy"in e&&e.destroy(),c.helper.remove(),c.draggable.remove();var g=a.get("controller.draggingNodeView.parentView.parentView");g&&"_fetchChildren"in g&&g.set("children",null),f.save().then(function(b){g&&"_fetchChildren"in g&&g.set("children",g._fetchChildren()),App.User.store.find(a._modelName(),{_id:a.get("content.id")}),App.User.store.find(a._modelName(),{_id:d}),notify("info",Em.I18n.t("webpage.moved_to",{name:b.get("name"),to:a.get("content.name")})),a.set("isOpen",!0),a.get("children")?a.get("children").content.pushObject(b):a.set("children",a._fetchChildren())})}})},doubleClick:function(){this.get("parentView.doubleClickAction")&&this.get("controller").send(this.get("parentView.doubleClickAction"),this.get("content"))},click:function(a){this._clickView(a)},_clickView:function(a,b){a&&a.stopPropagation(),this.get("controller").send("treeItemSelected",this.get("content"),!this.get("isSelected")),(!this.get("children")||b)&&this.set("children",this._fetchChildren()),this.set("isOpen",this.get("isSelected"))},_modelName:function(){return a("store"in this?this:this.get("content"))},_fetchChildren:function(){return App.User.store.find(this._modelName(),{parent:this.get("content.id")})}})}(),$(function(){"use strict";Ember.Handlebars.registerBoundHelper("currentDate",function(a){return moment().format(a||"LL")}),Ember.Handlebars.registerBoundHelper("timeAgo",function(a){var b=moment(a);return new Handlebars.SafeString('<time datetime="'+b.format()+'">'+b.fromNow()+"</time>")}),Ember.Handlebars.registerBoundHelper("formatDate",function(a,b){var c=b.hash.format?b.hash.format:"LLL",d=a?moment(a):moment(),e=d.format(c);return new Handlebars.SafeString("<time datetime="+a+">"+e+"</time>")}),Ember.Handlebars.registerBoundHelper("smartDate",function(a){var b,c=a?moment(a):moment();return c.clone().subtract("d",7)>=moment().startOf("day").subtract("d",8)?b=c.format("YYYY-MM-DD")===moment().format("YYYY-MM-DD")?Em.I18n.t("today")+", "+c.format("HH:mm"):c.format("YYYY-MM-DD")===moment().subtract("d",1).format("YYYY-MM-DD")?Em.I18n.t("yesterday")+", "+c.format("HH:mm"):c.format("dddd HH:mm"):(b=c.format("DD. "),b+=c.format(c.format("MM.YYYY")===moment().format("MM.YYYY")?"MMMM":"MMMM"),c.format("YYYY")!==moment().format("YYYY")&&(b+=c.format("YYYY"))),new Handlebars.SafeString("<time title='"+c.format("LLLL")+"' datetime='"+c.format("LLLL")+"'>"+b+"</time>")}),Ember.Handlebars.registerHelper("thisYear",function(a,b){return moment(this.get(a)).format("YYYY")===moment().format("YYYY")?b.fn(this):b.inverse(this)})}),function(){Handlebars.registerHelper("equal",function(a,b,c){if(arguments.length<3)throw new Error("Handlebars Helper equal needs 2 parameters");return a===this.get(b)?c.fn(this):"function"==typeof c.inverse?c.inverse(this):void 0}),Handlebars.registerHelper("equal2",function(a,b,c){if(arguments.length<3)throw new Error("Handlebars Helper equal needs 2 parameters");return"object"==typeof this&&this[a]&&(a=this[a]),"object"==typeof this&&this[b]&&(b=this[b]),a="function"==typeof this.get?this.get(a):"undefined"==typeof App.get(a)?a:App.get(a),b="function"==typeof this.get?this.get(b):"undefined"==typeof App.get(b)?b:App.get(b),a===b?c.fn(this):"function"==typeof c.inverse?c.inverse(this):void 0}),Ember.Handlebars.helper("dynamicPartial",function(){return Ember.Handlebars.helpers.partial.apply(this,arguments)}),Ember.Handlebars.registerHelper("tKey",function(a,b){var c=this.get(a);return b.hash.prefix&&(c=b.hash.prefix+"."+c),Em.I18n.t(c)})}(),function(){"use strict";Ember.View.reopen(Em.I18n.TranslateableAttributes),window.App=Ember.Application.create({}),window.App._curLang=currentLang,window.App.ApplicationAdapter=DS.RESTAdapter.extend({host:caminioHostname+"/caminio",headers:{"X-CSRF-Token":window.csrf,sideload:!0,namespaced:!0}}),window.App.caminioVersion=caminioVersion,window.App.siteVersion=siteVersion,window.App.ApplicationSerializer=DS.RESTSerializer.extend({serializeHasMany:function(a,b,c){c.options.embedded&&"always"===c.options.embedded?b[c.key]=a.get(c.key).map(function(a){var b=a.serialize();return a.get("id")&&(b._id=a.get("id")),b}):c.options.embedded&&"keys"===c.options.embedded&&(b[c.key]=[],b[c.key]=a.get(c.key).mapBy("id"))},serializeBelongsTo:function(a,b,c){c.options.embedded&&"always"===c.options.embedded&&a.get(c.key)?b[c.key]=a.get(c.key).toJSON():c.options.embedded&&"keys"===c.options.embedded?b[c.key]=a.get(c.key).get("id"):a.get(c.key)&&(b[c.key]=a.get(c.key).id)},serializeIntoHash:function(a,b,c,d){var e=Ember.String.decamelize(b.typeKey);a[e]=this.serialize(c,d)},typeForRoot:function(a){var b=Ember.String.camelize(a);return Ember.String.singularize(b)},primaryKey:"_id"}),currentUser.camDomains.map(function(a){a.changeUrl="/?camDomainId="+a._id}),window.App.set("_currentUser",currentUser),window.App.set("_currentUserHasMultiDomains",currentUser.camDomains.length>1),window.App.set("_currentDomain",currentDomain),window.App.set("_availableLanguages",Em.A(["de","en"])),window.DS.ArrayTransform=DS.Transform.extend({deserialize:function(a){return"array"==Ember.typeOf(a)?a:[]},serialize:function(a){var b=Ember.typeOf(a);return"array"==b?a:"string"==b?a.split(",").map(function(a){return jQuery.trim(a)}):[]}}),window.DS.ObjectTransform=DS.Transform.extend({deserialize:function(a){return Em.isNone(a)?{}:a},serialize:function(a){return Em.isNone(a)?{}:a}}),window.App.register("transform:array",DS.ArrayTransform),window.App.register("transform:object",DS.ObjectTransform),bootbox.setDefaults({locale:currentLang}),moment.lang(currentLang),CLDR.defaultLanguage=currentLang,window.setupCaminio=function(a){var b=function e(a){$(a.target).hasClass("toggle-apps-btn")||$(a.target).closest(".toggle-apps-btn").length>0||($("body").removeClass("toggle-apps"),$(document).off("click",e))};$(document).on("keypress",function(a){$(a.target).get(0).nodeName.match(/INPUT|TEXTAREA/)||99!==a.which||a.ctrlKey||a.metaKey||$(".toggle-apps-btn").click()}),a.find(".toggle-apps-btn").on("click",function(){$("body").toggleClass("toggle-apps"),$("body").hasClass("toggle-apps")?setTimeout(function(){$(document).on("click",b)},10):$(document).off("click",b)}),caminio.translateDataFields();var c={user:{}};for(var d in currentUser)d.match(/camDomains|mediafiles/)||(c.user[d]=currentUser[d]);App.User.store&&(App.User.store.pushPayload("user",c),App.set("emberUser",App.User.store.getById("user",currentUser._id)))},$.ajaxSetup({beforeSend:function(a,b){b.type.match(/POST|PUT|PATCH|DELETE/)&&a.setRequestHeader("X-CSRF-Token",csrf)}}),window.registeredCtrlS=[],window.App.setupCtrlS=function(a,b){window.registeredCtrlS.indexOf(a.id)>=0||(window.registeredCtrlS.push(a.id),$(document).on("keydown",function(c){83===c.keyCode&&(c.metaKey||c.ctrlKey)&&(c.preventDefault(),a.save().then(function(){notify("info",b)}))}))}}(),function(){"use strict";window.App.CodeMirrorView=Ember.TextArea.extend({classNames:["CodeMirror"],didInsertElement:function(){this._codeMirror=CodeMirror.fromTextArea(this.$()[0],{mode:"markdown",tabMode:"indent",lineWrapping:!0});var a=this;this._codeMirror.on("change",function(){a._preventLoop=!0,a.set("value",a._codeMirror.getValue())}),this.$().parent().find(".CodeMirror-vscrollbar").niceScroll()},willDestroyElement:function(){this._codeMirror.toTextArea()},selectedDidChange:function(){var a=this;return a._preventLoop?void(a._preventLoop=!1):void(a.get("value")&&a._codeMirror.setValue(a.get("value")))}.observes("value"),swapVal:function(a){a=a||"",this.set("value",a),this._codeMirror.setValue(this.get("value")),this._codeMirror.refresh()}})}(App),function(a){"use strict";a.Select2SelectView=Ember.Select.extend({prompt:Em.I18n.t("please_select"),classNames:["input-xlarge"],willInsertElement:function(){this.get("noPrompt")&&this.set("prompt",""),this.get("promptTranslation")&&this.set("prompt",Em.I18n.t(this.get("promptTranslation")))},didInsertElement:function(){Ember.run.scheduleOnce("afterRender",this,"processChildElements")},processChildElements:function(){var a=this,b={};this.get("noSearch")&&(b.minimumResultsForSearch=-1),this.$().select2(b).on("select2-open",function(){a.get("createAction")&&($("#select2-drop .select2-input").data("emberized")||($("#select2-drop .select2-input").data("emberized",!0),$("#select2-drop .select2-input").on("keyup",function(b){27===b.keyCode&&a.$().select2("close"),$("#select2-drop .select2-results").length<2&&this.value.length>0?$("#select2-drop .select2-no-results").text(Em.I18n.t(a.get("createTranslation"))):this.value.length>0&&$("#select2-drop .select2-no-results").text(Em.I18n.t(a.get("promptTranslation"))),13===b.keyCode&&(a.get("controller").send(a.get("createAction"),this.value,a.$()),a.$().select2("close"))})))}).on("change",function(){a.get("changeAction")&&a.get("controller").send(a.get("changeAction"),this.value,a.$())}),a.get("selectFirst")&&a.get("content.length")>0&&a.$().select2("val",a.get("content.firstObject.id"))},willDestroyElement:function(){this.$().select2("destroy")},selectedDidChange:function(){var a=this;setTimeout(function(){a.$()&&a.$().select2("val",a.get("value"))},100)}.observes("selection.@each")}),a.Select2TagView=Ember.TextField.extend({didInsertElement:function(){Ember.run.scheduleOnce("afterRender",this,"processChildElements")},processChildElements:function(){var a={};a.placeholder=Em.I18n.t("please_select"),a.allowClear=!0,a.closeOnSelect=!0,a.tokenSeparators=[","],a.width="100%",a.tags=this.get("tags")||[];var b=this.$().select2(a);b.prev("div").find("ul.select2-choices").sortable({containment:"parent",start:function(){b.select2("onSortStart")},update:function(){b.select2("onSortEnd")}})},willDestroyElement:function(){this.$().select2("destroy")},selectedDidChange:function(){var a=this.get("value");"string"==typeof a&&(a=a.split(",")),this.$().select2("val",a)}.observes("value")}),a.Select2CountryView=Ember.Select.extend({prompt:Em.I18n.t("select_country"),classNames:["input-xlarge"],willInsertElement:function(){var b=this;this.set("optionLabelPath","content.text"),this.set("optionValuePath","content.id");var c=$.getJSON("/caminio/util/countries?lang="+currentLang);return c.done(function(c){var d=[];for(var e in c)d.push({id:e,text:c[e]});d.sort(function(a,b){return a.text.toLowerCase()<b.text.toLowerCase()?-1:a.text.toLowerCase()>b.text.toLowerCase()?1:a.text.toLowerCase()===b.text.toLowerCase()?0:void 0}),b.set("content",d),setTimeout(function(){b.get("value")?b.$().select2("val",b.get("value")):a.get("_currentDomain.preferences.defaultCountry")&&b.$().select2("val",a.get("_currentDomain.preferences.defaultCountry"))},100)}),c},didInsertElement:function(){Ember.run.scheduleOnce("afterRender",this,"processChildElements")},processChildElements:function(){this.$().select2()},willDestroyElement:function(){this.$().select2("destroy")},selectedDidChange:function(){var a=this;setTimeout(function(){a.get("value")&&a.$().select2("val",a.get("value"))},100)}.observes("value")}),a.TypeaheadTextFieldView=Ember.TextField.extend({classNames:["input-xlarge"],didInsertElement:function(){Ember.run.scheduleOnce("afterRender",this,"processChildElements")},processChildElements:function(){var a;this.get("contentUrl")?a=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:this.get("contentUrl")}):this.get("localContent")&&(a=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,local:$.map(this.get("localContent"),function(a){return{value:a}})})),a&&(a.initialize(),this.$().typeahead(null,{displayKey:"value",source:a.ttAdapter()}))},willDestroyElement:function(){this.$().typeahead("destroy")}})}(App),function(a){"use strict";a._selTableItems=Ember.A(),a.TableController=Ember.ArrayController.extend({page:1,numRows:10,pages:[],sortProperties:[],sortAscending:!0,availableRows:[10,30,50],closestPages:function(){var a=this.get("page"),b=this.get("pages")[this.get("pages").length-1];return a>3?a-=3:a>2?a-=2:a>1&&(a-=1),b=b>=a+5?a+5:b,a>b-5&&this.get("pages").length>5&&(a=b-5),this.get("pages").slice(a-1,b)}.property("pages.length"),paginatedContent:function(){var a=(this.get("page")-1)*this.get("numRows"),b=this.get("page")*this.get("numRows"),c=parseInt(this.get("content.length")/this.get("numRows"));this.get("content.length")%this.get("numRows")>0&&(c+=1),this.set("pages",[]);for(var d=1;c>=d;d++)this.get("pages").push(d);return this.get("arrangedContent").slice(a,b)}.property("arrangedContent.[]","page","numRows"),someSelected:function(){return a.get("_selTableItems.length")>0&&a.get("_selTableItems.length")<this.get("content.length")}.property("App._selTableItems.length"),oneOrMoreSelected:function(){return a.get("_selTableItems.length")>0}.property("App._selTableItems.length"),actions:{sortByColumn:function(a,b){this.get("sortProperties").indexOf(a)>=0&&this.set("sortAscending",b||!this.get("sortAscending")),this.set("sortProperties",[a])},selectAllTableItems:function(){var b=this;return a._selTableItems.length>=this.get("content.length")?a._selTableItems.clear():a._selTableItems.length>0?(a._selTableItems.clear(),this.get("content").forEach(function(b){a._selTableItems.pushObject(b)})):void this.get("paginatedContent").forEach(function(c,d){d<=b.get("numRows")&&a._selTableItems.pushObject(c)})},goToPage:function(a){this.set("page",a)},goToLastPage:function(){this.set("page",this.get("pages.lastObject"))},goToFirstPage:function(){this.set("page",1)}}}),a.TableItemController=Ember.ObjectController.extend({isSelectedTableItem:function(){var b=this.get("content"),c=a._selTableItems.findBy("id",b.id);return"object"==typeof c}.property("App._selTableItems.@each"),curTranslation:function(){return this.get("content.translations").findBy("locale",a._curLang)}.property("App._curLang"),actions:{selectTableItem:function(){var b=this.get("content"),c=a._selTableItems.findBy("id",b.id);return c?a._selTableItems.removeObject(b):void a._selTableItems.pushObject(b)}}}),a.TableFooterPageItemController=Em.ObjectController.extend({isActive:function(){return this.get("content")===this.get("parentController.page")}.property("parentController.page")}),a.TableHeaderItemController=Em.ObjectController.extend({isSortingAsc:function(){return this.get("parentController.sortProperties").indexOf(this.get("content.name"))>=0&&this.get("parentController.sortAscending")}.property("parentController.sortProperties.@each","parentController.sortAscending"),isSortingDesc:function(){return this.get("parentController.sortProperties").indexOf(this.get("content.name"))>=0&&!this.get("parentController.sortAscending")}.property("parentController.sortProperties.@each","parentController.sortAscending"),calculateStyle:function(){var a="";return this.get("content.width")&&(a+="width: "+this.get("content.width")+";"),this.get("content.align")&&(a+="text-align: "+this.get("content.align")+";"),a}.property("content.width","content.align")})}(App),function(a){"use strict";a.Client=DS.Model.extend({name:DS.attr(),secret:DS.attr("string"),user:DS.attr("string"),scope:DS.attr("string",{defaultValue:"*"})})}(App),function(a){"use strict";a.Label=DS.Model.extend({name:DS.attr("string"),type:DS.attr("string"),bgColor:DS.attr("string",{defaultValue:"#548EE5"}),fgColor:DS.attr("string",{defaultValue:"#fff"}),usersAccess:DS.hasMany("user"),"private":DS.attr("boolean"),borderColor:DS.attr("string",{defaultValue:"#637dd4"}),styleAttrs:function(){return"background-color: "+this.get("bgColor")+"; color: "+this.get("fgColor")+"; border-color: "+this.get("borderColor")}.property("bgColor")})}(App),function(a){"use strict";a.Mediafile=DS.Model.extend({name:DS.attr(),contentType:DS.attr(),size:DS.attr("number"),createdAt:DS.attr("date"),preferences:DS.attr("object"),updatedAt:DS.attr("date"),createdBy:DS.belongsTo("user"),updatedBy:DS.belongsTo("user"),description:DS.attr(),copyright:DS.attr(),position:DS.attr("number"),isHidden:DS.attr("boolean",{defaultValue:!1}),isTeaser:DS.attr("boolean",{defaultValue:!1}),thumbnails:DS.attr("array"),parent:DS.attr("string"),relPath:DS.attr("string"),url:function(){return"/caminio/domains/"+currentDomain._id+"/preview/"+this.get("relPath")}.property("name"),publicUrl:function(){return"/files/"+this.get("relPath")}.property("name"),isImage:function(){return 0===this.get("contentType").indexOf("image")}.property("contentType"),humanSize:function(){return filesize(this.get("size"))}.property("size"),preferencesAsStr:function(){return JSON.stringify(this.get("preferences"))}.property("preferences"),getThumbDim:function(a){return this.get("preferences").thumbs&&this.get("preferences").thumbs[a]?this.get("preferences").thumbs[a]:null},setThumbDim:function(a,b){var c=this.get("preferences");c.thumbs=c.thumbs||{},c.thumbs[a]=b,this.set("preferences",c)},updateRelPath:function(){var a=this.get("parent")?this.get("parent"):"";a=a.length>0?a+"/":"",this.set("relPath",a+this.get("name"))}.observes("name","parent"),getBackgroundImage:function(){return this.get("isImage")?'background-image: url("'+this.get("url")+'");':void 0}.property("contentType")})}(App),function(a){"use strict";var b={};b[currentDomain._id]=50,a.User=DS.Model.extend({firstname:DS.attr("string"),lastname:DS.attr("string"),nickname:DS.attr("string"),email:DS.attr("string"),roles:DS.attr("object",{defaultValue:b}),currentDomainRole:function(a,b){return b&&Ember.set(this.get("roles"),currentDomain._id,b),Ember.get(this.get("roles"),currentDomain._id)||0
}.property("roles"),isAdmin:function(){return this.get("superuser")||100===this.get("roles")[currentDomain._id]}.property("roles."+currentDomain._id),isEditor:function(){return this.get("superuser")||this.get("roles")[currentDomain._id]>=60}.property("roles."+currentDomain._id),isTrusted:function(){return this.get("superuser")||this.get("roles")[currentDomain._id]>=80}.property("roles."+currentDomain._id),lang:DS.attr("string",{defaultValue:currentDomain.lang||"en"}),description:DS.attr("string"),superuser:DS.attr("boolean"),password:DS.attr(),passwordConfirmation:DS.attr(),camDomains:DS.attr("array"),apiEnabled:DS.attr("boolean"),apiKey:DS.attr("string"),apiUser:DS.attr("boolean",{defaultValue:!1}),clients:DS.hasMany("client"),remotePicUrl:DS.attr("string"),mediafiles:DS.hasMany("mediafile",{embedded:"always"}),notify:DS.attr("object"),picUrl:function(){return this.get("remotePicUrl")?this.get("remotePicUrl"):"/caminio/profile_pics/"+this.get("id")+"?d="+moment().toDate().getTime().toString()}.property("remotePicUrl"),mailto:function(){return"mailto:"+this.get("email")}.property("email"),inCurrentDomain:function(){return this.get("camDomains").indexOf(currentDomain._id)>=0}.property("camDomains"),fullname:function(){var a="";return this.get("firstname")&&this.get("firstname").length>0&&(a+=this.get("firstname")),a.length>0&&this.get("lastname")&&this.get("lastname").length>0&&(a+=" "),this.get("lastname")&&this.get("lastname").length>0&&(a+=this.get("lastname")),a.length<2&&(a+=this.get("email")),a}.property("firstname","lastname"),name:function(){return this.get("fullname")}.property("firstname","lastname"),apiUserRightsObserver:function(){this.get("apiUser")&&this.get("roles."+currentDomain._id)>60&&(this.set("roles."+currentDomain._id,60),$("#role-slider").slider("setValue",60),notify("error",Em.I18n.t("user.api_role_not_allowed")))}.observes("apiUser","roles."+currentDomain._id)})}(App),function(){"use strict";window.caminio=caminio||{},caminio.labels=caminio.labels||{},caminio.labels.getColors=function(){var a="";return[{bgc:"#428BCA",bc:"#26a",fgc:"#fff"},{bgc:"#F0AD4E",bc:"#c82",fgc:"#333a3a"},{bgc:"#1CAF9A",bc:"#087",fgc:"#fff"},{bgc:"#D9534F",bc:"#b32",fgc:"#fff"},{bgc:"#1d2939",bc:"#001",fgc:"#fff"},{bgc:"#00A0B1",bc:"#008299",fgc:"#fff"},{bgc:"#2E8DEF",bc:"#2672EC",fgc:"#fff"},{bgc:"#A700AE",bc:"#8C0095",fgc:"#fff"},{bgc:"#643EBF",bc:"#5133AB",fgc:"#fff"},{bgc:"#BF1E4B",bc:"#AC193D",fgc:"#fff"},{bgc:"#DC572E",bc:"#D24726",fgc:"#fff"},{bgc:"#00A600",bc:"#008A00",fgc:"#fff"},{bgc:"#0A5BC4",bc:"#094AB2",fgc:"#fff"}].forEach(function(b){a+='<span class="color" data-fg-color="'+b.fgc+'" data-bg-color="'+b.bgc+'" data-border-color="'+b.bc+'"style="background-color:'+b.bgc+"; color:"+b.fgc+"; border-color: "+b.bc+';"></span>'}),a},caminio.labels.getBoxes=function(){var a="";return App.User.store.all("label").content.forEach(function(b){a+='<span class="color" data-private="'+b.get("private")+'" data-id="'+b.id+'" title="'+b.get("name")+'" style="background-color:'+b.get("bgColor")+"; color:"+b.get("fgColor")+"; border-color: "+b.get("borderColor")+';"></span>'}),a}}(),$(function(){"use strict";function a(a,e,f){if(f=f||{},1===arguments.length&&"object"==typeof a&&(f=a,a=e=null),f.clearAll&&$("#notifications .notifications-collection").html(""),a){var g=$("<section/>");b(),g.addClass("notification notification-"+a).html(e),f.undo&&g.append(c(f.undo)),g.append(d()),$("#notifications .notifications-collection").append(g),g.slideDown(),f.keepVisible||setTimeout(function(){g.slideUp(),setTimeout(function(){g.remove()},500)},f.undo?15e3:5e3)}}function b(){$("#notifications .notifications-collection").length||$("#notifications").html($("<div/>").addClass("notifications-collection"))}function c(a){if("function"!=typeof a)throw new Error("options.undo must be a function");var b=$("<a/>").addClass("undo").attr("href","#");return b.html('<div class="text">'+Ember.I18n.t("undo")+"</div>").on("click",a),b}function d(){var a=$("<a/>").addClass("close").attr("href","#");return a.html('<span class="hide">'+Ember.I18n.t("close")+"</span>"),a.on("click",function(a){a.preventDefault(),$(this).closest(".notification").remove()}),a}a.processError=function(b,c){if("object"==typeof b.responseJSON&&(b=b.responseJSON),"object"==typeof b.details)if(b.details.code&&11e3===b.details.code)a("error",Ember.I18n.t("errors.duplicate_key",{name:b.details.err.split(" dup key: { :")[1].replace(/[\\\\"\}]*/g,"")}));else if(b.details.errors)for(var d in b.details.errors){var e=b.details.errors[d];a("error",Ember.I18n.t(e.message,{value:e.value}))}else b.details.message?a("error",b.details.message):a("error",b.details);else if("object"==typeof b.error)b.error.message&&a("error",b.error.message);else if(b.errors){for(var f in b.errors)if(b.errors[f].split(".").length>1)return a("error",Ember.I18n.t(b.errors[f],{name:c}));a("error",Ember.I18n.t("errors.db_field",{name:f,message:b.errors[f]}))}else a("error",b.details)},window.notify=a});