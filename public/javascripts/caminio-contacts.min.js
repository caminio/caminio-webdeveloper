/*! caminio-contacts 2014-07-01 
* Copyright (c) 2014 TASTENWERK 
* Available via the MIT license.
* see: http://opensource.org/licenses/MIT for blueprint.
*/
function initGMaps(a,b){var c=collectAddr(b)||"Universitaetsring 1, 1010 Wien, Austria";if(!(a.length<1)){var d=new google.maps.Geocoder,e=new google.maps.LatLng(-34.397,150.644),f={center:e,zoom:16};window.map=new google.maps.Map(a.get(0),f),d.geocode({address:c},function(a,b){if(a&&!(a.length<1)){b==google.maps.GeocoderStatus.OK&&map.setCenter(a[0].geometry.location);{new google.maps.Marker({map:map,position:a[0].geometry.location})}}})}}function collectAddr(a){if(a){var b="";return a.get("street")&&(b+=a.get("street")),b.length>0&&(b+=","),a.get("zip")&&(b+=a.get("zip")),a.get("zip")&&a.get("city")&&(b+=" "),a.get("city")&&(b+=a.get("city")),(a.get("city")||a.get("zip"))&&(b+=","),a.get("country")&&a.get("country"),b}}function updateGMaps(a){var b=collectAddr(a);if(b&&!(b.length<1)){if("undefined"==typeof map)return console.error("expected google map object to exist");{var c=new google.maps.Geocoder;new google.maps.LatLng(-34.397,150.644)}c.geocode({address:b},function(a,b){b==google.maps.GeocoderStatus.OK&&map.setCenter(a[0].geometry.location);new google.maps.Marker({map:map,position:a[0].geometry.location})})}}function QR8bitByte(a){this.mode=QRMode.MODE_8BIT_BYTE,this.data=a}function QRCode(a,b){this.typeNumber=a,this.errorCorrectLevel=b,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=new Array}function QRPolynomial(a,b){if(void 0==a.length)throw new Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=new Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}function QRRSBlock(a,b){this.totalCount=a,this.dataCount=b}function QRBitBuffer(){this.buffer=new Array,this.length=0}!function(a){a.fn.qrcode=function(b){"string"==typeof b&&(b={text:b}),b=a.extend({},{render:"canvas",width:256,height:256,typeNumber:-1,correctLevel:QRErrorCorrectLevel.H,background:"#ffffff",foreground:"#000000"},b);var c=function(){var a=new QRCode(b.typeNumber,b.correctLevel);a.addData(b.text),a.make();var c=document.createElement("canvas");c.width=b.width,c.height=b.height;for(var d=c.getContext("2d"),e=b.width/a.getModuleCount(),f=b.height/a.getModuleCount(),g=0;g<a.getModuleCount();g++)for(var h=0;h<a.getModuleCount();h++){d.fillStyle=a.isDark(g,h)?b.foreground:b.background;var i=Math.ceil((h+1)*e)-Math.floor(h*e),j=Math.ceil((g+1)*e)-Math.floor(g*e);d.fillRect(Math.round(h*e),Math.round(g*f),i,j)}return c},d=function(){var c=new QRCode(b.typeNumber,b.correctLevel);c.addData(b.text),c.make();for(var d=a("<table></table>").css("width",b.width+"px").css("height",b.height+"px").css("border","0px").css("border-collapse","collapse").css("background-color",b.background),e=b.width/c.getModuleCount(),f=b.height/c.getModuleCount(),g=0;g<c.getModuleCount();g++)for(var h=a("<tr></tr>").css("height",f+"px").appendTo(d),i=0;i<c.getModuleCount();i++)a("<td></td>").css("width",e+"px").css("background-color",c.isDark(g,i)?b.foreground:b.background).appendTo(h);return d};return this.each(function(){var a="canvas"==b.render?c():d();jQuery(a).appendTo(this)})}}(jQuery),QR8bitByte.prototype={getLength:function(){return this.data.length},write:function(a){for(var b=0;b<this.data.length;b++)a.put(this.data.charCodeAt(b),8)}},QRCode.prototype={addData:function(a){var b=new QR8bitByte(a);this.dataList.push(b),this.dataCache=null},isDark:function(a,b){if(0>a||this.moduleCount<=a||0>b||this.moduleCount<=b)throw new Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},make:function(){if(this.typeNumber<1){var a=1;for(a=1;40>a;a++){for(var b=QRRSBlock.getRSBlocks(a,this.errorCorrectLevel),c=new QRBitBuffer,d=0,e=0;e<b.length;e++)d+=b[e].dataCount;for(var e=0;e<this.dataList.length;e++){var f=this.dataList[e];c.put(f.mode,4),c.put(f.getLength(),QRUtil.getLengthInBits(f.mode,a)),f.write(c)}if(c.getLengthInBits()<=8*d)break}this.typeNumber=a}this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,b){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var c=0;c<this.moduleCount;c++){this.modules[c]=new Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++)this.modules[c][d]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(a,b),this.typeNumber>=7&&this.setupTypeNumber(a),null==this.dataCache&&(this.dataCache=QRCode.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,b)},setupPositionProbePattern:function(a,b){for(var c=-1;7>=c;c++)if(!(-1>=a+c||this.moduleCount<=a+c))for(var d=-1;7>=d;d++)-1>=b+d||this.moduleCount<=b+d||(this.modules[a+c][b+d]=c>=0&&6>=c&&(0==d||6==d)||d>=0&&6>=d&&(0==c||6==c)||c>=2&&4>=c&&d>=2&&4>=d?!0:!1)},getBestMaskPattern:function(){for(var a=0,b=0,c=0;8>c;c++){this.makeImpl(!0,c);var d=QRUtil.getLostPoint(this);(0==c||a>d)&&(a=d,b=c)}return b},createMovieClip:function(a,b,c){var d=a.createEmptyMovieClip(b,c),e=1;this.make();for(var f=0;f<this.modules.length;f++)for(var g=f*e,h=0;h<this.modules[f].length;h++){var i=h*e,j=this.modules[f][h];j&&(d.beginFill(0,100),d.moveTo(i,g),d.lineTo(i+e,g),d.lineTo(i+e,g+e),d.lineTo(i,g+e),d.endFill())}return d},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=a%2==0);for(var b=8;b<this.moduleCount-8;b++)null==this.modules[6][b]&&(this.modules[6][b]=b%2==0)},setupPositionAdjustPattern:function(){for(var a=QRUtil.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var f=-2;2>=f;f++)for(var g=-2;2>=g;g++)this.modules[d+f][e+g]=-2==f||2==f||-2==g||2==g||0==f&&0==g?!0:!1}},setupTypeNumber:function(a){for(var b=QRUtil.getBCHTypeNumber(this.typeNumber),c=0;18>c;c++){var d=!a&&1==(b>>c&1);this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d}for(var c=0;18>c;c++){var d=!a&&1==(b>>c&1);this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d}},setupTypeInfo:function(a,b){for(var c=this.errorCorrectLevel<<3|b,d=QRUtil.getBCHTypeInfo(c),e=0;15>e;e++){var f=!a&&1==(d>>e&1);6>e?this.modules[e][8]=f:8>e?this.modules[e+1][8]=f:this.modules[this.moduleCount-15+e][8]=f}for(var e=0;15>e;e++){var f=!a&&1==(d>>e&1);8>e?this.modules[8][this.moduleCount-e-1]=f:9>e?this.modules[8][15-e-1+1]=f:this.modules[8][15-e-1]=f}this.modules[this.moduleCount-8][8]=!a},mapData:function(a,b){for(var c=-1,d=this.moduleCount-1,e=7,f=0,g=this.moduleCount-1;g>0;g-=2)for(6==g&&g--;;){for(var h=0;2>h;h++)if(null==this.modules[d][g-h]){var i=!1;f<a.length&&(i=1==(a[f]>>>e&1));var j=QRUtil.getMask(b,d,g-h);j&&(i=!i),this.modules[d][g-h]=i,e--,-1==e&&(f++,e=7)}if(d+=c,0>d||this.moduleCount<=d){d-=c,c=-c;break}}}},QRCode.PAD0=236,QRCode.PAD1=17,QRCode.createData=function(a,b,c){for(var d=QRRSBlock.getRSBlocks(a,b),e=new QRBitBuffer,f=0;f<c.length;f++){var g=c[f];e.put(g.mode,4),e.put(g.getLength(),QRUtil.getLengthInBits(g.mode,a)),g.write(e)}for(var h=0,f=0;f<d.length;f++)h+=d[f].dataCount;if(e.getLengthInBits()>8*h)throw new Error("code length overflow. ("+e.getLengthInBits()+">"+8*h+")");for(e.getLengthInBits()+4<=8*h&&e.put(0,4);e.getLengthInBits()%8!=0;)e.putBit(!1);for(;;){if(e.getLengthInBits()>=8*h)break;if(e.put(QRCode.PAD0,8),e.getLengthInBits()>=8*h)break;e.put(QRCode.PAD1,8)}return QRCode.createBytes(e,d)},QRCode.createBytes=function(a,b){for(var c=0,d=0,e=0,f=new Array(b.length),g=new Array(b.length),h=0;h<b.length;h++){var i=b[h].dataCount,j=b[h].totalCount-i;d=Math.max(d,i),e=Math.max(e,j),f[h]=new Array(i);for(var k=0;k<f[h].length;k++)f[h][k]=255&a.buffer[k+c];c+=i;var l=QRUtil.getErrorCorrectPolynomial(j),m=new QRPolynomial(f[h],l.getLength()-1),n=m.mod(l);g[h]=new Array(l.getLength()-1);for(var k=0;k<g[h].length;k++){var o=k+n.getLength()-g[h].length;g[h][k]=o>=0?n.get(o):0}}for(var p=0,k=0;k<b.length;k++)p+=b[k].totalCount;for(var q=new Array(p),r=0,k=0;d>k;k++)for(var h=0;h<b.length;h++)k<f[h].length&&(q[r++]=f[h][k]);for(var k=0;e>k;k++)for(var h=0;h<b.length;h++)k<g[h].length&&(q[r++]=g[h][k]);return q};for(var QRMode={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},QRErrorCorrectLevel={L:1,M:0,Q:3,H:2},QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;QRUtil.getBCHDigit(b)-QRUtil.getBCHDigit(QRUtil.G15)>=0;)b^=QRUtil.G15<<QRUtil.getBCHDigit(b)-QRUtil.getBCHDigit(QRUtil.G15);return(a<<10|b)^QRUtil.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;QRUtil.getBCHDigit(b)-QRUtil.getBCHDigit(QRUtil.G18)>=0;)b^=QRUtil.G18<<QRUtil.getBCHDigit(b)-QRUtil.getBCHDigit(QRUtil.G18);return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},getPatternPosition:function(a){return QRUtil.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case QRMaskPattern.PATTERN000:return(b+c)%2==0;case QRMaskPattern.PATTERN001:return b%2==0;case QRMaskPattern.PATTERN010:return c%3==0;case QRMaskPattern.PATTERN011:return(b+c)%3==0;case QRMaskPattern.PATTERN100:return(Math.floor(b/2)+Math.floor(c/3))%2==0;case QRMaskPattern.PATTERN101:return b*c%2+b*c%3==0;case QRMaskPattern.PATTERN110:return(b*c%2+b*c%3)%2==0;case QRMaskPattern.PATTERN111:return(b*c%3+(b+c)%2)%2==0;default:throw new Error("bad maskPattern:"+a)}},getErrorCorrectPolynomial:function(a){for(var b=new QRPolynomial([1],0),c=0;a>c;c++)b=b.multiply(new QRPolynomial([1,QRMath.gexp(c)],0));return b},getLengthInBits:function(a,b){if(b>=1&&10>b)switch(a){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:return 8;case QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+a)}else if(27>b)switch(a){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+a)}else{if(!(41>b))throw new Error("type:"+b);switch(a){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+a)}}},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;b>d;d++)for(var e=0;b>e;e++){for(var f=0,g=a.isDark(d,e),h=-1;1>=h;h++)if(!(0>d+h||d+h>=b))for(var i=-1;1>=i;i++)0>e+i||e+i>=b||(0!=h||0!=i)&&g==a.isDark(d+h,e+i)&&f++;f>5&&(c+=3+f-5)}for(var d=0;b-1>d;d++)for(var e=0;b-1>e;e++){var j=0;a.isDark(d,e)&&j++,a.isDark(d+1,e)&&j++,a.isDark(d,e+1)&&j++,a.isDark(d+1,e+1)&&j++,(0==j||4==j)&&(c+=3)}for(var d=0;b>d;d++)for(var e=0;b-6>e;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&&(c+=40);for(var e=0;b>e;e++)for(var d=0;b-6>d;d++)a.isDark(d,e)&&!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e)&&(c+=40);for(var k=0,e=0;b>e;e++)for(var d=0;b>d;d++)a.isDark(d,e)&&k++;var l=Math.abs(100*k/b/b-50)/5;return c+=10*l}},QRMath={glog:function(a){if(1>a)throw new Error("glog("+a+")");return QRMath.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;a>=256;)a-=255;return QRMath.EXP_TABLE[a]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},i=0;8>i;i++)QRMath.EXP_TABLE[i]=1<<i;for(var i=8;256>i;i++)QRMath.EXP_TABLE[i]=QRMath.EXP_TABLE[i-4]^QRMath.EXP_TABLE[i-5]^QRMath.EXP_TABLE[i-6]^QRMath.EXP_TABLE[i-8];for(var i=0;255>i;i++)QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]]=i;QRPolynomial.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=new Array(this.getLength()+a.getLength()-1),c=0;c<this.getLength();c++)for(var d=0;d<a.getLength();d++)b[c+d]^=QRMath.gexp(QRMath.glog(this.get(c))+QRMath.glog(a.get(d)));return new QRPolynomial(b,0)},mod:function(a){if(this.getLength()-a.getLength()<0)return this;for(var b=QRMath.glog(this.get(0))-QRMath.glog(a.get(0)),c=new Array(this.getLength()),d=0;d<this.getLength();d++)c[d]=this.get(d);for(var d=0;d<a.getLength();d++)c[d]^=QRMath.gexp(QRMath.glog(a.get(d))+b);return new QRPolynomial(c,0).mod(a)}},QRRSBlock.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],QRRSBlock.getRSBlocks=function(a,b){var c=QRRSBlock.getRsBlockTable(a,b);if(void 0==c)throw new Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);for(var d=c.length/3,e=new Array,f=0;d>f;f++)for(var g=c[3*f+0],h=c[3*f+1],i=c[3*f+2],j=0;g>j;j++)e.push(new QRRSBlock(h,i));return e},QRRSBlock.getRsBlockTable=function(a,b){switch(b){case QRErrorCorrectLevel.L:return QRRSBlock.RS_BLOCK_TABLE[4*(a-1)+0];case QRErrorCorrectLevel.M:return QRRSBlock.RS_BLOCK_TABLE[4*(a-1)+1];case QRErrorCorrectLevel.Q:return QRRSBlock.RS_BLOCK_TABLE[4*(a-1)+2];case QRErrorCorrectLevel.H:return QRRSBlock.RS_BLOCK_TABLE[4*(a-1)+3];default:return void 0}},QRBitBuffer.prototype={get:function(a){var b=Math.floor(a/8);return 1==(this.buffer[b]>>>7-a%8&1)},put:function(a,b){for(var c=0;b>c;c++)this.putBit(1==(a>>>b-c-1&1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0),a&&(this.buffer[b]|=128>>>this.length%8),this.length++}},function(){"use strict";window.App.ContactController=Ember.ObjectController.extend({actions:{markFavorite:function(a){var b=a.get("favorite");a.get("isFavorite")?(b.splice(b.indexOf(currentUser._id),1),a.set("favorite",b)):(b.push(currentUser._id),a.set("favorite",b)),a.save().then(function(){a.get("isFavorite")?notify("info",Em.I18n.t("contact.marked_favorite",{name:a.get("name")})):notify("info",Em.I18n.t("contact.unmarked_favorite",{name:a.get("name")}))})},getQRCode:function(a){$.get(caminioHostname+"/caminio/contacts/export.vcard?_id="+a.id,function(a){bootbox.dialog({title:Em.I18n.t("contact.qr_code"),message:'<div class="align-center" id="qrcode"></div>',onEscape:function(){}}),$("#qrcode").qrcode(a)})},editContact:function(a){this.transitionToRoute("contact.edit",a.id)}}})}.call(),function(){"use strict";window.App.ContactEditController=Ember.Controller.extend({actions:{addHistoryEntry:function(a){this.get("model").save().then(function(){a.set("content",""),notify("info",Ember.I18n.t("contact.history.saved"))})},save:function(a){var b=this;a.save().then(function(){notify("info",Ember.I18n.t("contact.saved",{name:a.get("fullname")})),b.transitionToRoute("contacts")}).catch(function(a){notify.processError(a.responseJSON)})}}})}.call(),function(a){"use strict";a.ContactTemplateController=Em.ObjectController.extend({actions:{saveContactTemplate:function(a){a.save().then(function(){$("#template-name").closest("div").removeClass("field-with-error"),notify("info",Ember.I18n.t("contact_template.saved",{name:a.get("name")}))}).catch(function(a){console.log(a),notify.processError(a.responseJSON)})},removeField:function(a,b){if(!a.id)return Ember.run(a,"destroy");var c=-1;b.get("contact_fields.content").forEach(function(b,d){b.id===a.id&&(c=d)}),c>-1&&$.ajax({url:"/caminio/contact_templates/"+b.id+"/remove_field/"+a.id,type:"delete",headers:{"X-CSRF-Token":csrf}}).done(function(){b.get("contact_fields").removeAt(c),b.save()})},changeFieldName:function(a){var b=this;bootbox.prompt(Em.I18n.t("contact_template.field.name"),function(c){c&&c.length>0&&(a.set("name",c),b.get("model").save().then(function(){notify("info",Em.I18n.t("contact_template.field.saved"))}).catch(function(b){notify.processError(b.responseJSON,a.get("name"))}))})},editFieldProps:function(a){$(".modal[data-id="+a.get("id")+"]").modal("show")},toggleVisibility:function(a){var b=this;a.set("hidden",!a.get("hidden")),this.get("model").save().then(function(){b.get("hidden")?notify("info",Em.I18n.t("contact_template.field.saved_hidden",{name:a.get("name")})):notify("info",Em.I18n.t("contact_template.field.saved_visible",{name:a.get("name")}))})},toggleDefault:function(a){a.set("isDefault",!a.get("isDefault"))},toggleVisible:function(a){a.set("isVisible",!a.get("isVisible"))},removeTemplate:function(a){var b=this;bootbox.confirm(Em.I18n.t("contact_template.really_delete",{name:a.get("name")}),function(c){c&&(a.deleteRecord(),a.save().then(function(){notify("info",Em.I18n.t("contact_template.deleted",{name:a.get("name")})),b.transitionToRoute("contact_templates")}))})}}})}(App),function(a){"use strict";a.ContactTemplateEditController=Em.ObjectController.extend({actions:{closeToolbox:function(){var a=this;this.get("context").get("isDirty")?bootbox.confirm(Em.I18n.t("unsaved_data_continue"),function(b){b&&renderListView(a)}):this.transitionTo("contact_templates")}}}),a.ContactTemplatesNewController=a.ContactTemplateEditController.extend()}(App),function(){"use strict";Ember.Handlebars.registerHelper("translatedField",function(a){return Ember.I18n.t("contact_template.field."+a.hashContexts.val)})}.call(),function(a){"use strict";function b(b){var f={};return f=b.get("selectedContact")?{_id:b.get("selectedContact.id")}:$("#quick-search").val().length>0?d(f,a._hintFields):e(f,a._curTemplate.get("contact_fields")),c(f),f}function c(b){return a._selLabels.get("firstObject.id")&&(b.labels=a._selLabels.get("firstObject.id")),b}function d(a,b){return a.or=[],b.forEach(function(b){if(b.get("hint").match(/firstname|lastname|email|phone/)){var c={};c["fields."+b.get("contactField")]="regexp(/"+$("#quick-search").val()+"/i)",a.or.push(c)}}),c(a),a}function e(a,b){return b.forEach(function(b){switch(b.get("type")){case"textbox":case"textarea":b.get("value")&&b.get("value").length>0&&(a["fields."+b.get("contactField")]="regexp(/"+b.get("value")+"/i)");break;case"checkbox":b.get("value")&&(a["fields."+b.get("contactField")]="true")}}),c(a),a}function f(){setTimeout(function(){$("table.contacts tfoot th:first").attr("colspan",$("table.contacts tbody tr:first td:visible").length)},100)}Ember.Handlebars.registerBoundHelper("getContactField",function(a,b){var c=b.hash.field,d=a.get("fields."+c.get("contactField"));d="undefined"==typeof d?"":d;var e;switch("undefined"==typeof d&&c.get("defaultValue")&&c.get("defaultValue").length>0&&(d=c.get("defaultValue")),"string"==typeof d&&""===d&&c.get("defaultValue")&&c.get("defaultValue").length>0&&(d=c.get("defaultValue")),c.get("type")){case"checkbox":e=d?'<i class="fa fa-check-square-o"></i>':'<i class="fa fa-square-o"></i>';break;default:e=d}return new Handlebars.SafeString(e)},"fields");a._searchAttrs={favorite:currentUser._id},a.ContactDetailsView=Ember.View.extend({templateName:"contact/details",didInsertElement:function(){this.$(".sub-navbar li[data-ctmpl-id="+a._curTemplate.get("id")+"]").find("a").tab("show")}}),a.ContactsController=Ember.Controller.extend({needs:["contacts_table"],actions:{goToContactTemplates:function(){this.transitionToRoute("contact_templates")},saveContact:function(a){var b=this;a.save().then(function(){notify("info",Ember.I18n.t("contact.created",{name:b.get("selectedContact.name")})),b.get("contacts").findBy("id",a.id).reload().then(function(){b.view.rerender()})}).catch(function(a){console.error(a),notify.processError(a.responseJSON)})},removeContact:function(a){var b=this;a.deleteRecord(),a.save().then(function(){notify("info",Ember.I18n.t("contact.removed",{name:b.get("selectedContact.name")})),b.view.rerender()}).catch(function(a){console.error(a),notify.processError(a.responseJSON)})},search:function(b){this.set("searchTriggered",!0),b?(delete a._searchAttrs.favorite,a._searchAttrs=d(a._searchAttrs,a._hintFields)):a._searchAttrs=e(a._searchAttrs,a._curTemplate.get("contact_fields")),a._searchContacts(this,a._searchAttrs),delete a._searchAttrs.favorite},saveSearch:function(){var b=e({},a._curTemplate.get("contact_fields")),c=this;bootbox.prompt(Em.I18n.t("search.name"),function(a){var d=c.store.createRecord("contact_search_query",{name:a,query:JSON.stringify(b)});d.save().then(function(){notify("info",Em.I18n.t("search.saved_successfully",{name:a}))})})},toggleAdvSearch:function(){this.set("advSearch",this.get("advSearch")?!1:!0),this.get("advSearch")?setTimeout(function(){$(".adv-search").slideDown(),$(".search-group").slideUp()},1):($(".adv-search").slideUp(),$(".search-group").slideDown())},closeDetails:function(){$(".contact-details").hide(),$(".table-wrapper").fadeIn(300)},genCSV:function(c){var d=caminioHostname+"/caminio/contacts/export.csv?camDomain="+currentDomain._id+"&templateId="+a._curTemplate.get("id")+"&"+$.param(b(this));c?bootbox.alert('<a href="'+d+'">'+Em.I18n.t("contacts.right_click_this_link_and_copy")+"</a>"):location.href=d},exportTemplate:function(){var c=caminioHostname+"/caminio/contacts/export.csv?templateId="+a._curTemplate.get("id")+"&templateExport=true&"+$.param(b(this));location.href=c},importCSV:function(){bootbox.dialog({title:Em.I18n.t("contacts.CSV_import"),message:'<form action="/caminio/contacts/import.csv" method="post" enctype="multipart/form-data"><input type="file" name="csv_file"></form>',buttons:{upload:{label:"upload",className:"primary",callback:function(a){var b=$(a.target).closest(".modal").find("form");b.slideUp(),b.after('<div class="progress progress-striped active"><div class="progress-bar"  role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"><span class="sr-only">processing import</span></div></div>'),b.submit()}}}})},genVCard:function(){location.href=caminioHostname+"/caminio/contacts/export.vcard?"+$.param(b(this))},genEmailAddresses:function(){var b=[],c=this.get("controllers.contacts_table").get("content");if(a._curTemplate.get("contact_fields").forEach(function(a){a.get("hint")&&a.get("hint").toLowerCase().match(/email/)&&b.push(a.get("contactField"))}),b.length>0){var d="mailto:?cc=";b.forEach(function(a){c.forEach(function(b){d+=b.get("fields")[a]+", "})});var e=$("<a/>").attr("href",d);e=e[0],$("body").append(e),e.click(),e.remove()}else bootbox.alert(Ember.I18n.t("no_email_field"))}},setupTemplateSelect2:function(){function b(b){var d=[];b.contact_templates.forEach(function(a){a.isVisible&&d.push({id:a._id,text:a.name})}),$("#select-template").select2({minimumResultsForSearch:-1,placeholder:"",data:d}).on("change",function(b){var d=c.store.getById("contact_template",b.val);a.set("_curTemplate",d),f(c)}),$("#select-template").val().length<1&&a._curTemplate&&$("#select-template").select2("val",a._curTemplate.get("id"))}var c=this;$.getJSON("/caminio/contact_templates").done(b)}}),a._searchContacts=function(b,c){b.store.find("contact",c).then(function(c){b.get("controllers.contacts_table").set("content",c);var d=a._selContacts.toArray();d.forEach(function(c){b.get("controllers.contacts_table").get("content").findBy("id",c.get("id"))||a._selContacts.removeObject(c)})})}}(App),function(){"use strict";window.App.ContactsNewView=Ember.View.extend({didInsertElement:function(){var a=this.$();setTimeout(function(){console.log(a),a.find(".sub-navbar li:first a").tab("show")},200)}}),window.App.ContactsNewController=Ember.Controller.extend({actions:{create:function(a){var b=this;a.save().then(function(){b.transitionToRoute("contacts"),notify("info",Ember.I18n.t("contact.created",{name:a.get("fullname")}))}).catch(function(a){notify.processError(a.responseJSON)})}}})}.call(),function(a){"use strict";a._selContacts=Ember.A(),a.ContactsTableController=Ember.ArrayController.extend({page:1,numRows:10,pages:[],sortProperties:["createdAt"],sortAscending:!0,availableRows:[10,30,50],closestPages:function(){var a=this.get("page"),b=this.get("pages")[this.get("pages").length-1];return a>3?a-=3:a>2?a-=2:a>1&&(a-=1),b=b>=a+5?a+5:b,a>b-5&&this.get("pages").length>5&&(a=b-5),this.get("pages").slice(a-1,b)}.property("pages.length"),paginatedContent:function(){var a=(this.get("page")-1)*this.get("numRows"),b=this.get("page")*this.get("numRows"),c=parseInt(this.get("content.length")/this.get("numRows"));this.get("content.length")%this.get("numRows")>0&&(c+=1),this.set("pages",[]);for(var d=1;c>=d;d++)this.get("pages").push(d);return this.get("arrangedContent").slice(a,b)}.property("arrangedContent.[]","page","numRows"),someSelected:function(){return a.get("_selContacts.length")>0&&a.get("_selContacts.length")<this.get("content.length")}.property("App._selContacts.length"),oneOrMoreSelected:function(){return a.get("_selContacts.length")>0}.property("App._selContacts.length"),actions:{sortByColumn:function(a,b){var c="fields."+a.get("contactField");this.get("sortProperties").indexOf(c)>=0&&this.set("sortAscending",b||!this.get("sortAscending")),this.set("sortProperties",[c])},selectContact:function(b){var c=a._selContacts.findBy("id",b.id);return c?a._selContacts.removeObject(b):void a._selContacts.pushObject(b)},selectAllContacts:function(){var b=this;return a._selContacts.length>=this.get("content.length")?a._selContacts.clear():a._selContacts.length>0?(a._selContacts.clear(),this.get("content").forEach(function(b){a._selContacts.pushObject(b)})):void this.get("paginatedContent").forEach(function(c,d){d<=b.get("numRows")&&a._selContacts.pushObject(c)})},goToContact:function(a){this.transitionToRoute("contact",a)},editContact:function(a){this.transitionToRoute("contact.edit",a)},goToPage:function(a){this.set("page",a)},goToLastPage:function(){this.set("page",this.get("pages.lastObject"))},goToFirstPage:function(){this.set("page",1)}}}),a.ContactsFooterPageItemController=Em.ObjectController.extend({isActive:function(){return this.get("content")===this.get("parentController.page")}.property("parentController.page")}),a.ContactsHeaderItemController=Em.ObjectController.extend({isSortingAsc:function(){return this.get("parentController.sortProperties").indexOf("fields."+this.get("content.contactField"))>=0&&this.get("parentController.sortAscending")}.property("parentController.sortProperties.@each","parentController.sortAscending"),isSortingDesc:function(){return this.get("parentController.sortProperties").indexOf("fields."+this.get("content.contactField"))>=0&&!this.get("parentController.sortAscending")}.property("parentController.sortProperties.@each","parentController.sortAscending")})}(App),function(a){"use strict";a.ContactsTableItemController=Ember.ObjectController.extend({isSelectedContact:function(){var b=this.get("content"),c=a._selContacts.findBy("id",b.id);return"object"==typeof c}.property("App._selContacts.@each"),actions:{toggleFavorite:function(a){var b=a.get("favorite").indexOf(currentUser._id);b>=0?a.get("favorite").splice(b,1):a.get("favorite").push(currentUser._id),a.save().then(function(){notify("info",Em.I18n.t("contact.marked_favorite",{name:a.get("name")}))})},toggleCheckboxOrSelect:function(a){var b=this.get("content");if("checkbox"===a.get("type")){var c=this.get("content.fields");return c[a.get("contactField")]=c[a.get("contactField")]?!1:!0,b.set("fields",c),this.get("content").save().then(function(){notify("info",Em.I18n.t("contact.saved",{name:b.get("name")}))})}this.send("selectContact",this.get("content"))},removeContact:function(){function b(){$.ajax({url:"/caminio/contacts/"+e+"/restore",type:"post"}).done(function(){c.store.find("contact",{_id:e}).then(function(b){d=b.toArray()[0],c.get("parentController.content").pushObject(d),a._selContacts.pushObject(d),notify("info",Em.I18n.t("contact.restored",{name:d.get("name")}),{clearAll:!0})})})}var c=this,d=this.get("content"),e=d.get("id");d.deleteRecord(),d.save().then(function(){c.get("parentController.content").removeObject(d),notify("info",Em.I18n.t("contact.deleted",{name:d.get("name")}),{undo:b})})}}})}(App),App.IndexController=Ember.ArrayController.extend({sortProperties:["name"],sortAscending:!0}),function(a){"use strict";a.ItemController=Ember.ObjectController.extend({isSelectedContact:function(){return this.get("content.id")===this.get("parentController.selectedContact.id")}.property("parentController.selectedContact"),isMultiSelectedContact:function(){return this.get("content.multiSelectContact")||!1}.property("content.multiSelectContact"),actions:{}})}(App),function(a){a.ToolboxController=Ember.Controller.extend({})}(App),function(){"use strict";window.App.Contact=DS.Model.extend({tags:DS.attr("array"),favorite:DS.attr("array",{defaultValue:[currentUser._id]}),notes:DS.hasMany("note",{embedded:"always"}),labels:DS.hasMany("label",{async:!0,embedded:"keys"}),createdAt:DS.attr("date",{defaultValue:new Date}),updatedAt:DS.attr("date",{defaultValue:new Date}),updatedBy:DS.belongsTo("user"),createdBy:DS.belongsTo("user"),fields:DS.attr("object"),_getHintField:function(a){var b=this,c="";return App._hintFields.some(function(d){return d.get("hint")===a?(c=b.get("fields."+d.get("contactField")),!0):void 0
}),c},firstname:function(){return this._getHintField("firstname")}.property("fields"),lastname:function(){return this._getHintField("lastname")}.property("fields"),about:function(){return this._getHintField("about")}.property("fields"),name:function(){var a=this._getHintField("firstname")||"",b=this._getHintField("lastname")||"";return(a.length>0?a:"")+(a.length>0&&b.length>0?" ":"")+(b.length?b:"")}.property("fields"),emails:function(){var a=this,b=[];return App._hintFields.forEach(function(c){if("email"===c.get("hint")){var d=a.get("fields."+c.get("contactField")),e=c.label;d&&d.length>0&&b.push({email:d,title:e+": "+d,label:e,mailto:"mailto:"+d})}}),b}.property("fields"),phones:function(){var a=this,b=[];return App._hintFields.forEach(function(c){if("phone"===c.get("hint")){var d=a.get("fields."+c.get("contactField")),e=c.label;d&&d.length>0&&b.push({phone:d,title:e+": "+d,label:e,mailto:"tel:"+d})}}),b}.property("fields"),org:function(){return this._getHintField("organization")}.property("fields"),city:function(){return this._getHintField("city")}.property("fields"),zip:function(){return this._getHintField("zip")}.property("fields"),street:function(){return this._getHintField("street")}.property("fields"),country:function(){return this._getHintField("country")}.property("fields"),state:function(){return this._getHintField("state")}.property("fields"),position:function(){return this._getHintField("position")}.property("fields"),isFavorite:function(){return this.get("favorite").indexOf(currentUser._id)>=0}.property("favorite")})}.call(),function(){"use strict";window.App.ContactField=DS.Model.extend({name:DS.attr("string"),type:DS.attr("string"),css:DS.attr("string"),sortable:DS.attr("boolean",{defaultValue:!0}),openDiv:DS.attr("boolean",{defaultValue:!1}),horizontalLine:DS.attr("boolean",{defaultValue:!1}),altFormTitle:DS.attr("string"),closeDiv:DS.attr("boolean",{defaultValue:!1}),tableCss:DS.attr("string"),value:DS.attr("string"),hidden:DS.attr("boolean"),hint:DS.attr(),label:DS.attr(),hiddenInForm:DS.attr("boolean"),position:DS.attr("number"),defaultValue:DS.attr("string"),transformer:DS.attr("string"),contactField:DS.attr("string"),contactTemplateId:DS.attr("string"),availableOptions:DS.attr("array"),spare:DS.attr("boolean"),classes:DS.attr("string"),placeholder:DS.attr("string"),namespace:DS.attr("string"),validator:DS.attr("string"),computeClasses:function(){var a=this.get("classes");return a&&a.length>0?a:"checkbox"===this.get("type")?"col-md-10":""}.property("classes"),isCustomDiv:function(){return this.get("classes")&&this.get("classes").indexOf("col-md-offset-2")<0}.property("classes"),availableOptionsObserver:function(a){a._attributes.availableOptions&&"string"==typeof a._attributes.availableOptions&&this.set("availableOptions",a._attributes.availableOptions.split(","))}.observes("availableOptions"),calculateTableStyle:function(){return this.get("tableCss")?this.get("tableCss"):""}.property("tableCss"),isTextbox:function(){return this.get("type").match(/^text/)}.property("type"),isTextarea:function(){return"textarea"===this.get("type")}.property("type"),isRadio:function(){return"radio"===this.get("type")}.property("type"),isCheckbox:function(){return"checkbox"===this.get("type")}.property("type"),isSelect:function(){return"select"===this.get("type")}.property("type")}),Ember.Inflector.inflector.irregular("contactField","contact_fields")}.call(),function(a){"use strict";a.ContactSearchQuery=DS.Model.extend({name:DS.attr("string"),description:DS.attr(),query:DS.attr(),"private":DS.attr("boolean",{defaultValue:!0})}),Ember.Inflector.inflector.irregular("contactSearchQuery","contact_search_queries")}(App),function(){"use strict";window.App.ContactTemplate=DS.Model.extend({description:DS.attr("string"),name:DS.attr("string"),contact_fields:DS.hasMany("contact_field",{embedded:"always"}),isDefault:DS.attr("boolean",{defaultValue:!1}),isVisible:DS.attr("boolean",{defaultValue:!0}),hrefId:function(){return"#"+this.get("id")}.property("id")}),Ember.Inflector.inflector.irregular("contactTemplate","contact_templates"),Ember.Inflector.inflector.irregular("contactField","contact_fields")}.call(),function(){"use strict";window.App.Note=DS.Model.extend({content:DS.attr("string"),createdAt:DS.attr("date"),createdBy:DS.belongsTo("user"),type:DS.attr("string"),isQuestion:function(){return"question"===this.get("type")}.property("type"),isImportant:function(){return"important"===this.get("type")}.property("type"),isPhone:function(){return"phone"===this.get("type")}.property("type")})}(App),function(a){"use strict";window.App.ContactEditView=Ember.View.extend({didInsertElement:function(){var b=this.$();setTimeout(function(){var c=b.find('.contact-nav li a[href="#'+a._curTemplate.get("id")+'"]');c.length<1&&(c=b.find(".contact-nav li:first a")),c.click()},50)}})}(App),function(a){"use strict";a.ContactTemplateEditView=Ember.View.extend({didInsertElement:function(){this.$(".ctmpl-toolbox select").select2()}}),a.ContactTemplatesNewView=a.ContactTemplateEditView.extend()}(App),function(a){"use strict";a.ContactTemplatesFormView=Ember.View.extend({didInsertElement:function(){var a=this;a._setupDragAndDrop(),a.$("#template-name").focus(),this.$().on("mouseenter",".move-field",function(){$(this).closest(".field-item").addClass("hovered")}).on("mouseleave",".move-field",function(){$(this).closest(".field-item").removeClass("hovered")})},contentObserver:function(){return"undefined"==typeof this.get("controller.model.dirtyType")||this.get("lastDirtyType")?(this.set("lastDirtyType",!1),void this.rerender()):this.set("lastDirtyType",!0)}.observes("controller.model.dirtyType","controller.model.isReloading"),_setupDragAndDrop:function(){var a=this;setTimeout(function(){a.$(".field-item").each(function(){a._setupDraggable($(this))}),a._setupDroppable(a.get("controller"))},500)},_setupDroppable:function(a){var b=a.get("model"),c=this;$(".drop-field").droppable({activeClass:"ui-state-hover",hoverClass:"ui-state-active",tolerance:"pointer",over:function(a,b){b.helper.addClass("valid-drop")},out:function(a,b){b.helper.removeClass("valid-drop")},drop:function(d,e){{var f=$(this).closest(".field-item");f.attr("data-field-id")}return b.get("id")?e.helper.hasClass("form-group")?c._movedAndDroppedExistingFormElem(a,e,f):e.helper.attr("data-id")&&e.helper.attr("data-id").length>1?c._droppedElemFromToolbox(a,e,f):c._droppedNewElemFromToolbox(a,e):bootbox.alert(Em.I18n.t("contact_template.must_be_saved_first"),function(){$("#template-name").closest("div").addClass("field-with-error"),setTimeout(function(){$("#template-name").focus()},500)})}})},_setupDraggable:function(a){a.draggable({handle:".move-field",revert:"invalid",helper:"clone",start:function(a,b){$(b.helper).css({width:$(this).outerWidth(),height:$(this).outerHeight()})}})},_movedAndDroppedExistingFormElem:function(a,b,c){var d=a.get("model");a.store.find("contact_field",b.helper.attr("data-field-id")).then(function(a){b.helper.closest(".contact-template-body").find(".field-item").each(function(b){a.set("contactTemplateId",d.get("id")),$(this).attr("data-field-id")===selfId&&a.set("position",b+1)}),b.draggable.insertAfter(c),c.effect("highlight",{color:"#ffc"},2e3),b.helper.remove();var e=[];$(".contact-template-body").find(".field-item").each(function(){e.push($(this).attr("data-field-id"))}),$.ajax({url:"/caminio/contact_templates/"+d.id+"/reorder_fields",data:{order:e},type:"POST",headers:{"X-CSRF-Token":csrf}}).done(function(){d.reload()})})},_droppedElemFromToolbox:function(a,b,c){var d=a.get("model"),e=$(".contact-template-body [data-field-id="+b.helper.attr("data-id")+"]");return e.length>0?(e.effect("highlight",{duration:3e3,color:"#d55"}),notify("error",Em.I18n.t("contact_template.field.already_in_form",{name:d.get("name")}))):void a.store.find("contact_field",b.helper.attr("data-id")).then(function(a){d.get("contact_fields").pushObject(a);var e=a.serialize();e._id=a.get("id"),$.post("/caminio/contact_templates/"+d.get("id")+"/add_field",{contact_field:e,position:c.index(".drop-field")+1}).done(function(){d.reload(),b.helper.remove()})})},_droppedNewElemFromToolbox:function(a,b){var c=a.get("model"),d=a.store.createRecord("contact_field");d.set("type",b.helper.attr("data-type")),d.set("contactTemplateId",c.get("id")),b.helper.remove(),bootbox.prompt(Em.I18n.t("contact_template.field.enter_name"),function(b){return b?void a.store.find("contact_field",{name:b}).then(function(a){return a.length>0?notify("error",Em.I18n.t("contact_template.field.with_name_exists",{name:b})):(d.set("name",b),c.get("contact_fields").pushObject(d),d.save(),void c.reload())}):d.deleteRecord()})}})}(App),function(a){"use strict";a.ContactView=Ember.View.extend({})}(App),function(a){"use strict";a.ContactsTableView=Ember.View.extend({templateName:"contacts_table",didInsertElement:function(){this.$("table.caminio thead .sortable-asc:first").click()},removeLoader:function(){$(".caminio-table-wrapper").removeClass("loading")}.on("didInsertElement")})}(App),function(a){"use strict";a.ContactsView=Ember.View.extend({didInsertElement:function(){$(".contact-details").hide(),$(".table-wrapper").show(),this.get("controller").set("view",this);var b=this;b.get("context").store.find("contact_template").then(function(a){b.get("controller").set("templates",a)}),this.$("#quick-search").focus(),this.$("#quick-search").on("keydown",function(a){13===a.keyCode&&$("#search-btn").click()});var c=this.get("controller");$("#saved-searches").select2({placeholder:Em.I18n.t("please_select"),data:this.get("controller.savedSearches").map(function(a){return{id:a.get("id"),text:a.get("name")}})}).on("change",function(b){var d=c.store.getById("contact_search_query",b.val);a._searchContacts(c,JSON.parse(d.get("query")))})}})}(App),function(a){"use strict";window.App.TextField=Ember.TextField.extend({fieldId:null,didInsertElement:function(){var a=this.get("parentView.controller.contact"),b=this.get("fieldId"),c=a.get("fields")||{};Ember.set(this,"value",Ember.get(c,b))},valueChange:function(){var a=this.get("parentView.controller.contact"),b=this.get("fieldId"),c=a.get("fields")||{};Ember.set(c,b,this.get("value"))}.observes("value")}),window.App.SelectField=a.Select2SelectView.extend({fieldId:null,willInsertElement:function(){this.set("content",this.get("contactField.availableOptions"))},didInsertElement:function(){var a=this.get("parentView.controller.contact"),b=this.get("fieldId"),c=a.get("fields")||{};this.set("value",c[b]),Ember.run.scheduleOnce("afterRender",this,"processChildElements")},valueChange:function(){var a=this.get("parentView.controller.contact"),b=this.get("fieldId"),c=a.get("fields")||{};Ember.set(c,b,this.get("value")),a.set("fields",c)}.observes("value")}),window.App.TextArea=Ember.TextArea.extend({fieldId:null,didInsertElement:function(){var a=this.get("parentView.controller.contact"),b=this.get("fieldId"),c=a.get("fields")||{};this.set("value",c[b])},valueChange:function(){var a=this.get("parentView.controller.contact"),b=this.get("fieldId"),c=a.get("fields")||{};Ember.set(c,b,this.get("value")),a.set("fields",c)}.observes("value")}),window.App.Checkbox=Ember.Checkbox.extend({init:function(){this._super(),this.on("change",this,this._updateElementValue)},didInsertElement:function(){var a=this.get("fieldId"),b=this.get("contact.fields")||{};this.$().attr("checked",b[a])},valueChange:function(){var a=this.get("fieldId"),b=this.get("contact.fields")||{};Ember.set(b,a,this.$().is(":checked")),this.get("contact").set("fields",b)}.observes("checked"),_updateElementValue:function(){Ember.set(this,"checked",this.$().is(":checked")),this.valueChange()}})}(App),function(a){a.ToolboxView=Ember.View.extend({didInsertElement:function(){var a=this.get("controller.fields"),b=this;a.isFulfilled?this._setupFields(a):a.then(function(){b._setupFields(a)}),$(".modal").on("click",".delete-contact-field",function(){$("[data-field-id="+$(this).attr("data-id")+"]").click()})},_setupFields:function(a){var b=[];a.sortBy("name").forEach(function(a){a.get("contactField")&&(b.indexOf(a.get("contactField"))>=0||(b.push(a.get("contactField")),$("#all-fields").append('<li data-id="'+a.get("contactField")+'">'+a.get("name")+' &nbsp; <span class="desc">'+a.get("label")+"</span></li>")))}),$(".ctmpl-toolbox li").draggable({revert:!0,helper:"clone",start:function(a,b){$(b.helper).css({width:$(this).outerWidth(),height:$(this).outerHeight()})}})}})}(App),function(){"use strict";if("de"===currentLang){var a={"nav.contacts":"Personen","nav.contact_templates":"Vorlagen","contacts.title":"Personen","contacts.back":"zurück zu den Kontakten","contacts.search.details":"Detailsuche","contacts.search.quick":"Schnelle Suche","contacts.total":"Gesamt","contacts.CSV_import":"Template oder CSV hochladen auf Server","contacts.CSV_export":"CSV herunterladen auf PC","contacts.template_export":"Template herunterladen auf PC","contacts.CSV_link":"Link zur CSV","contacts.vCard_export":"vCard export","contacts.send_email":"Email an alle","contacts.add_selected_to_label":"{{count}} ausgewählte Kontakte zu Label hinzufügen","contacts.right_click_this_link_and_copy":'Rechts-Klicken und "Zieladresse kopieren"',"contacts.advanced_search":"Erweiterte Sucheinstellungen","contacts.search":"Suche","search.in_templates":"Verwende Vorlage","search.saved":"Gespeicherte Suchabfragen","search.save":"Diese Suchabfrage speichern","search.name":"Suchabfrage speichern unter","search.saved_successfully":"Suchabfrage {{name}} wurde gespeichert","contact.save":"Speichern","contact.created":"Kontakt {{name}} wurde erfolgreich gespeichert","contact.saved":"Kontakt {{name}} wurde gespeichert","contact.deleted":"Kontakt {{name}} wurde gelöscht","contact.restored":"Kontakt {{name}} wurde wiederhergestellt","contact.create":"Erstellen","contact.new":"Neuer Kontakt","contact.edit":"Kontakt bearbeiten","contact.name.title":"Name","contact.email":"Email","contact.phone":"Telefon","contact.firstname":"Vorname","contact.lastname":"Nachname","contact.address.title":"Addresse","contact.tabs.general":"Allegemein","contact.tabs.settings":"Einstellungen","contact.tabs.history":"Notizen","contact.addr.street":"Straße","contact.addr.zip":"PLZ","contact.addr.city":"Stadt","contact.labels.work":"Arbeit","contact.labels.private":"Privat","contact.labels.other":"Anderes","contact.qr_code":"Zum Exportieren aufs Telefon anzeigen","contact.history.saved":"Verlauf gespeichert","contact.history.add_note":"Notiz hinzufügen","contact.mark_favorite":"Zu Favoriten hinzufügen","contact.marked_favorite":"{{name}} ist jetzt ein Favorit","contact.unmarked_favorite":"{{name}} ist kein Favorit mehr","contact.notes":"Notizen für diesen Kontakt anzeigen","contact.about":"Über {{name}}",contact_template:"Vorlage","contact_templates.title":"Vorlagen","contact_templates.edit":"Vorlage bearbeiten","contact_templates.back":"zurück zu den Vorlagen","contact_templates.subtitle":"With templates, you can define fields to show in a separate tab. A template is also available in the search box, so you can limit your search to values you enter in fields defined in a template","contact_templates.new":"Neue Vorlage","contact_templates.none_yet":"Es gibt derzeit noch keine Vorlagen","contact_template.select_a_template_first_or":"Vorlage auswählen oder","contact_template.create_a_new_template":"neue Vorlage erstellen","contact_template.name":"Name der Vorlage","contact_template.save":"Vorlage speichern","contact_template.create":"Vorlage erstellen","contact_template.created":"Vorlage {{name}} wurde erfolgreich angelegt","contact_template.saved":"Vorlage {{name}} wurde gespeichert","contact_template.toggle_default":"Diese Vorlage zur Standardvorlage machen","contact_template.is_default":"Diese Vorlage ist derzeit als Standardvorlage markiert","contact_template.toggle_visible":"Diese Vorlage ausblenden machen","contact_template.really_delete":"Vorlage {{name}} wirklich löschen?","contact_template.deleted":"Vorlage {{name}} wurde gelöscht","contact_template.toolbox":"Werkzeuge","contact_template.toolbox.existing_fields":"Bekannte Felder in der DB","contact_template.toolbox.field_elements":"Feldtyp","contact_template.must_be_saved_first":"Die Vorlage muss zuerst benannt und gespeichert werden","contact_template.field.name":"Feldname","contact_template.field.delete":"Feld in allen Vorlagen löschen","contact_template.field.deleted":"Feld {{name}} wurde gelöscht","contact_template.field.saved_visible":"Feld {{name}} wird in der Tabellenansicht angezeigt","contact_template.field.saved_hidden":"Feld {{name}} wird nicht in der Tabellenansicht angezeigt","contact_template.field.hidden":"Feld wird nicht in der Tabellenansicht angezeigt","contact_template.field.sortable":"Sortierbar in Tabelle","contact_template.field.open_div":"Öffnet DIV-Container","contact_template.field.horizontal_line":"Horizontale Line","contact_template.field.alt_form_title":"Formulartitel","contact_template.field.close_div":"Schließt DIV-Container","contact_template.field.css":"CSS Style","contact_template.field.table_css":"CSS table Style","contact_template.field.hiddenInForm":"Unsichtbar in Formularansicht","contact_template.field.placeholder":"Platzhalter","contact_template.field.default_value":"Standardwert","contact_template.field.available_options":"Optionen Einschränken","contact_template.field.spare":"Nur Feld (keine Beschriftung davor) anzeigen","contact_template.field.classes":"CSS Klassen","contact_template.field.validator":"Validatoren (fortgeschritten)","contact_template.field.hint":"Hint","contact_template.field.label":"Label","contact_template.field.with_name_exists":"Ein Feld mit dem Namen {{name}} gibt es bereits. Name muss eindeutig sein","contact_template.field.enter_name":"Feldname","contact_template.field.already_in_form":"Ein Feld mit dem Namen {{name}} befindet sich bereits in dieser Vorlage","contact_template.field.type":"Typ","contact_template.field.properties":"Feldeigenschaften","contact_template.field.saved":"Feldeinstellungen wurden gespeichert","contact_template.field.edit_properties":"Feldeigenschaften bearbeiten","contact_template.errors.already_exists":"Ein Feld mit dem Namen {{name}} existiert bereits","contact_template.types.textbox":"Textbox","contact_template.types.textbox_title":"Feldname","contact_template.drag_to_add_field":"Feld in den Formulardesigner links ziehen um es hinzuzufügen","contact_template.drop_field_here":"Ein Feld aus den Werkzeugen hier her ziehen um es hinzuzufügen","contact_template.trigger_search_to_see_results":"Suchknopf betätigen, um Resultate anzuzeigen","contact_template.types.textarea":"Fließtext","contact_template.types.select":"Auswahlfeld",invalid_email:"Die angegebene Email Adresse ist ungültig: {{value}}",no_email_field:"In diesem Kontakt wurde kein Email-Feld gefunden","note.post":"Notiz speichern","note.history":"Verlauf","note.write_quick":"Eine Notiz hinterlassen","note.saved":"Notiz in {{name}} wurde gespeichert","note.really_delete":"Notiz in {{name}} wirklich löschen?","note.deleted":"Notiz in {{name}} wurde gelöscht"};for(var b in a)Em.I18n.translations[b]=a[b]}}.call(),function(){"use strict";if("en"===currentLang){var a={"nav.contacts":"Contacts","nav.contact_templates":"Templates","contacts.title":"Contacts","contacts.subtitle":"Your contact manager at your service","contacts.back":"back to contacts","contacts.search.details":"Search details","contacts.search.quick":"Quick search","contacts.total":"Total","contacts.CSV_import":"Template or CSV upload to server","contacts.CSV_export":"CSV download to your PC","contacts.template_export":"Template download to your PC","contacts.CSV_link":"Link to CSV","contacts.send_email":"Email all","contacts.vCard_export":"vCard export","contacts.right_click_this_link_and_copy":"Right-click this link and copy it","contacts.add_selected_to_label":"Add {{count}} selected contacts to label","contacts.advanced_search":"Advanced search settings","contacts.search":"Search","search.in_templates":"Use template","search.saved":"Saved search queries","search.save":"Save this search query","search.name":"Save search query as","search.saved_successfully":"Search query {{name}} has been saved successfully","contact.qr_code":"Export to phone","contact.save":"Save","contact.created":"Contact {{name}} has been created successfully","contact.saved":"Contact {{name}} has been saved","contact.deleted":"Contact {{name}} has been removed","contact.restored":"Contact {{name}} has been restored","contact.create":"Create","contact.new":"New contact","contact.edit":"Edit contact","contact.name.title":"Name","contact.email":"Email","contact.phone":"Phone","contact.firstname":"Firstname","contact.lastname":"Lastname","contact.address.title":"Address","contact.tabs.general":"General","contact.tabs.settings":"Settings","contact.tabs.history":"Notes","contact.mark_favorite":"Mark this contact as favorite","contact.marked_favorite":"{{name}} is now a favorite","contact.unmarked_favorite":"{{name}} is no longer a favorite","contact.notes":"Show notes for this contact","contact.about":"About {{name}}","contact.addr.street":"Street","contact.addr.zip":"ZIP","contact.addr.city":"City","contact.labels.work":"Work","contact.labels.private":"Private","contact.labels.other":"Other",contact_template:"Template","contact_templates.title":"Templates","contact_templates.edit":"Edit contact templates","contact_templates.back":"back to templates","contact_templates.subtitle":"With templates, you can define fields to show in a separate tab. A template is also available in the search box, so you can limit your search to values you enter in fields defined in a template","contact_templates.new":"New template","contact_templates.none_yet":"There is no template here yet",contact_templates:"Back to contact templates","contact_template.select_a_template_first_or":"Select a template or","contact_template.create_a_new_template":"create a new template","contact_template.name":"Template name","contact_template.save":"Save template","contact_template.create":"Create template","contact_template.created":"Template {{name}} has been created and saved successfully","contact_template.saved":"Template {{name}} has been saved successfully","contact_template.toggle_default":"Toggle this template to be default","contact_template.is_default":"This is the default template","contact_template.errors.already_exists":"A field with name {{name}} already exists","contact_template.toggle_visible":"Toggle visibility status of this template","contact_template.is_visible":"This template is visible","contact_template.really_delete":"Really delete template {{name}}?","contact_template.deleted":"Template {{name}} has been deleted","contact_template.must_be_saved_first":"The template must be named and saved first","contact_template.toolbox":"Toolbox","contact_template.toolbox.existing_fields":"Existing fields","contact_template.toolbox.field_elements":"Field elements","contact_template.field.name":"Field name","contact_template.field.delete":"Delete field in all templates","contact_template.field.deleted":"Field {{name}} has been deleted","contact_template.field.saved_visible":"Field {{name}} is now visible in table","contact_template.field.saved_hidden":"Field {{name}} is not shown in table view","contact_template.field.hidden":"Field is not shown in table view","contact_template.field.sortable":"Sortable in table","contact_template.field.css":"CSS Style definition","contact_template.field.open_div":"opens DIV-Container","contact_template.field.close_div":"closes DIV-Container","contact_template.field.horizontal_line":"Horizontal Line","contact_template.field.alt_form_title":"Form title","contact_template.field.table_css":"CSS table Style","contact_template.field.hiddenInForm":"Hidden in form","contact_template.field.placeholder":"Placeholder","contact_template.field.default_value":"Default value","contact_template.field.available_options":"Available options","contact_template.field.spare":"Spare (no label)","contact_template.field.classes":"CSS Classes","contact_template.field.validator":"Validators","contact_template.field.hint":"Hint","contact_template.field.label":"Label","contact_template.field.type":"Type","contact_template.field.with_name_exists":"A field with name {{name}} already exists. Name must be unique","contact_template.field.field_name":"Field name","contact_template.field.already_in_form":"A field with name {{name}} is already part of this template","contact_template.field.properties":"Field properties","contact_template.field.saved":"Field settings have been saved","contact_template.field.edit_properties":"Edit this field properties","contact_template.types.textbox":"Textbox","contact_template.types.textbox_title":"Field name","contact_template.drag_to_add_field":"Drag a field box into the template design area on the left to add a new field","contact_template.drop_field_here":"Drag a field from the toolbar and drop it here to extend this template","contact_template.trigger_search_to_see_results":"Trigger the search button to see results","contact_template.types.textarea":"Textarea","contact_template.types.select":"Select field",invalid_email:"The email address entered is not valid: {{value}}",no_email_field:"There is no email field in the current contacts","note.post":"Post note","note.history":"History","note.write_quick":"Write a quick note","note.saved":"Note in {{name}} has been saved","note.really_delete":"Really delete note in {{name}}","note.deleted":"Note in {{name}} has been deleted"};for(var b in a)Em.I18n.translations[b]=a[b]}}.call(),function(a){"use strict";a.ContactFieldSettingsModalComponent=Ember.Component.extend({actions:{saveContactField:function(a){var b=this.get("template");$(".modal[data-id="+a.get("id")+"]").modal("hide").on("hidden.bs.modal",function(){b.save().then(function(){notify("info",Em.I18n.t("contact_template.field.saved"))})})},removeFieldFromAll:function(b){function c(){$.ajax({url:"/caminio/contact_fields/"+b.get("contactField"),type:"delete"}).done(function(){notify("info",Em.I18n.t("contact_template.field.deleted",{name:b.get("name")})),$("#all-fields [data-id="+b.get("contactField")+"]").remove(),b.deleteRecord()})}bootbox.confirm(Em.I18n.t("really_delete",{name:b.get("name")}),function(d){d&&$(".modal[data-id="+b.get("id")+"]").modal("hide").on("hidden.bs.modal",function(){a.ContactTemplate.store.all("contact_template").forEach(function(d,e){var f=d.get("contact_fields").findBy("contactField",b.get("contactField"));if(f)return d.get("contact_fields").removeObject(f),e===a.ContactTemplate.store.all("contact_template").get("length")-1?d.save().then(c):void d.save()})})})}}})}(App),function(a){"use strict";function b(a){var b='<form class="bootbox-form"><div class="form-group row"><input type="text" value="'+(a.get("name")||"")+'" autocomplete="off" class="bootbox-input bootbox-input-text form-control name col-md-12"></div><div class="row margin-top clearfix colors"><label class="control-label col-md-3">'+Em.I18n.t("label.select_color")+'</label><div class="col-md-9">'+caminio.labels.getColors()+'</div></div><div class="row margin-top clearfix colors"><label class="control-label col-md-3">'+Em.I18n.t("label.private")+'</label><div class="col-md-9"><input type="checkbox" class="private"></div></div></form>';return b}a.ContactLabelsItemController=Ember.Controller.extend({isActive:function(){return a.get("_selLabels").findBy("id",this.get("content.id"))}.property("App._selLabels.@each")}),a.ContactLabelsComponent=Ember.Component.extend({hasSelectedContacts:function(){return a._selContacts.length>0}.property("App._selContacts.@each"),didInsertElement:function(){this.set("labels",a.User.store.find("label",{type:"regexp(/contact|project/)"})),this.set("user",a.User.store.getById("user",currentUser._id))},actions:{removeLabel:function(a){bootbox.confirm(Em.I18n.t("label.really_delete",{name:a.get("name")}),function(b){b&&(a.deleteRecord(),a.save().then(function(){notify("info",Em.I18n.t("label.deleted",{name:a.get("name")}))}).catch(function(a){notify("error",a)}))})},showLabelContactsOrAddLabel:function(b){var c=a.get("_selContacts");if(c.get("length")>0)c.forEach(function(a){return a.get("labels").findBy("id",b.get("id"))?(a.get("labels").removeObject(b),a.save()):void a.get("labels").then(function(){a.get("labels").pushObject(b),a.save()})});else{if(a.get("_selLabels").clear(),this.get("curFilter")&&this.get("curFilter")===b.get("id"))return this.set("curFilter",null),a.get("_selLabels").clear(),void delete a._searchAttrs.labels;this.set("curFilter",b.get("id")),a._searchAttrs.labels=b.get("id"),a._searchAttrs.labels&&this.get("mainController").send("search"),a._selLabels.findBy("id",b.get("id"))?a._selLabels.clear():a._selLabels.pushObject(b)}},editLabel:function(c){function d(){var b=$(".bootbox .color.active");b.length||(b=$(".bootbox .color:first").addClass("active")),c.set("bgColor",b.attr("data-bg-color")),c.set("fgColor",b.attr("data-fg-color")),c.set("borderColor",b.attr("data-border-color"));var d=a.User.store.getById("user",currentUser._id);$(".bootbox .private").is(":checked")?c.get("usersAccess").pushObject(d):c.get("usersAccess").removeObject(d),c.set("name",$(".edit-label-modal .name").val()),e()}function e(){var b=c.id?!1:!0;c.save().then(function(c){b?notify("info",Em.I18n.t("label.created",{name:c.get("name")})):notify("info",Em.I18n.t("label.saved",{name:c.get("name")})),h.set("labels",a.User.store.find("label",{type:"contact"}))}).catch(function(a){console.error(a),notify("error",a)})}function f(){var a=$(this);a.find("form").on("submit",function(b){b.preventDefault(),d(),a.modal("hide")}),setTimeout(function(){a.find("input[type=text]:first").focus()},500),a.find(".color").on("click",function(){a.find(".color").removeClass("active"),$(this).addClass("active")}),a.find("input[type=checkbox]").attr("checked",c.get("private")),a.find(".color[data-bg-color="+c.get("bgColor")+"]").addClass("active")}function g(){c.isDirty&&c.deleteRecord()}var h=this,i=a.User.store;c||(c=i.createRecord("label",{userAccess:this.get("user"),type:"contact"})),bootbox.dialog({title:Em.I18n.t("name"),message:b(c),className:"edit-label-modal",buttons:{save:{label:Em.I18n.t("save"),className:"primary",callback:d}}}).on("shown.bs.modal",f).on("hide.bs.modal",g)}}})}(App),function(a){"use strict";a.NotesHistoryComponent=Ember.Component.extend({reverseNotes:function(){return this.get("content.notes").reverseObjects()}.property("content.notes.@each"),didInsertElement:function(){var b=this;a.User.store.findById("user",currentUser._id).then(function(c){b.set("user",c),b._clearNewNote(),a._HistoryMasonryInit()}),initGMaps(this.$(".location-on-map"),this.get("controller.model"))},actions:{postNote:function(){var b=this,c=this.get("content");c.get("notes").unshiftObject(this.get("newNote")),c.save().then(function(){a._HistoryMasonryDestroy(),notify("info",Em.I18n.t("note.saved",{name:c.get("name")})),b._clearNewNote(),c.reload().then(function(){setTimeout(function(){a._HistoryMasonryInit()},100)})})},removeNote:function(b){var c=this,d=this.get("content");bootbox.confirm(Em.I18n.t("note.really_delete"),function(e){e&&(a._HistoryMasonryDestroy(),c.get("content").get("notes").removeObject(b),d.save().then(function(){notify("info",Em.I18n.t("note.deleted",{name:d.get("name")})),setTimeout(function(){a._HistoryMasonryInit()},100)}))})},toggleType:function(a){this.get("newNote").set("type",a)}},_clearNewNote:function(){this.set("newNote",a.User.store.createRecord("note",{createdBy:this.get("user"),createdAt:new Date}))}}),a.ContactView=Ember.View.extend({didInsertElement:function(){a._HistoryMasonryInit(),initGMaps(this.$(".location-on-map"),this.get("controller.model"))}}),a._HistoryMasonryInit=function(){$("#history").masonry({itemSelector:".history-box",gutter:30}),$(".history-box").removeClass("left-box").removeClass("right-box"),$(".history-box").each(function(){var a=$(this).css("left");
$(this).addClass("0px"===a?"left-box":"right-box")})},a._HistoryMasonryDestroy=function(){$("#history").masonry("destroy")}}(App),function(a){a._selLabels=Em.A(),a.Router.map(function(){this.resource("contacts",{path:"/contacts"}),this.resource("contacts.new",{path:"/contacts/new"}),this.resource("contact",{path:"/contacts/:id"}),this.resource("contact.edit",{path:"/contacts/:id/edit"}),this.resource("contact_templates",{path:"/contact_templates"}),this.resource("contact_templates.new",{path:"/contact_templates/new"}),this.resource("contact_template",{path:"/contact_templates/:id"},function(){this.route("edit")})}),a.IndexRoute=Ember.Route.extend({redirect:function(){this.transitionTo("contacts")}}),a.ContactsRoute=Ember.Route.extend({beforeModel:function(){var a=this.store.find("contact_search_query",{"private":!0,createdBy:currentUser._id}),b=this;return a.then(function(a){b.set("savedSearches",a)}),a},setupController:function(a){this.controllerFor("contacts_table");a.set("savedSearches",this.get("savedSearches")),a.setupTemplateSelect2(),a.send("search")},renderTemplate:function(){this.render(),this.render("contacts.table",{into:"contacts",outlet:"table",controller:"contacts_table"})}}),a.ContactRoute=Ember.Route.extend({model:function(a){return this.store.find("contact",a.id)}}),a.ContactsNewRoute=Ember.Route.extend({model:function(){var a=this.store.createRecord("contact");return a},setupController:function(a,b){a.set("templates",this.store.all("contact_template")),a.set("contact",b)}}),a.ContactEditRoute=Ember.Route.extend({model:function(a){return this.store.find("contact",a.id)},setupController:function(a,b){a.set("templates",this.store.all("contact_template")),a.set("contact",b)}}),a.ContactTemplatesRoute=Ember.Route.extend({renderTemplate:function(){this.render(),this.render("contact_template/select_template_first",{outlet:"cur-editing-template",into:"contact_templates"}),this.render("contact_templates/list",{outlet:"contact-template-control",into:"contact_templates"})},model:function(){return this.store.find("contact_template")}}),a.ContactTemplatesNewRoute=Em.Route.extend({setupController:function(){c=this.controllerFor("contact_template"),c.set("model",this.store.createRecord("contact_template")),t=this.controllerFor("toolbox"),t.set("fields",this.store.find("contact_field"))},renderTemplate:function(){this.render(),this.render("contact_templates.form",{into:"contact_templates.new",outlet:"form",controller:"contact_template"}),this.render("toolbox",{into:"contact_templates.new",outlet:"toolbox",controller:"toolbox"})}}),a.ContactTemplateEditRoute=Ember.Route.extend({model:function(a,b){return this.store.find("contact_template",b.params.id)},setupController:function(a,b){c=this.controllerFor("contact_template"),c.set("model",b),t=this.controllerFor("toolbox"),t.set("fields",this.store.find("contact_field"))},renderTemplate:function(){this.render(),this.render("contact_templates.form",{into:"contact_template.edit",outlet:"form",controller:"contact_template"}),this.render("toolbox",{into:"contact_template.edit",outlet:"toolbox",controller:"toolbox"})}}),a._hintFields=[],a.ApplicationRoute=Ember.Route.extend({beforeModel:function(){function b(b){function d(b){return a._hintFields.length>0?c.store.find("contact_template").then(e):(b.content&&(a._hintFields=b.content.content?b.content.content:b.content),a._hintFields.forEach(function(a){a.set("contactField",a.id)}),void c.store.find("contact_template").then(e))}function e(c){return a._curTemplate?b():(c.some(function(b){return b.get("isDefault")?(a._curTemplate=b,!0):void 0}),void b())}c.store.find("contact_field",{hint:"ne(null)"}).then(d)}var c=this,d=new Ember.RSVP.Promise(b);return d},setupController:function(b){this.store.find("user"),this.store.find("label",{type:"regexp(/contact|project/)"}),b.set("curTemplate",a._curTemplate)},actions:{goToContacts:function(){this.transitionTo("contacts")},cancel:function(a){a.deleteRecord(),this.transitionTo("contacts")}}}),a.ApplicationView=Em.View.extend({didInsertElement:function(){setupCaminio(this.$())}})}(App);